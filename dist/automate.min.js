!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.automate=e():t.automate=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e);var o=Object.prototype.toString,i=Object.getPrototypeOf;function u(t,e,n){if(g(t)){for(var r=0;r<t.length;r++)if(e(t[r],r))return}else if(w(t))for(var o in t)if((n||t.hasOwnProperty(o))&&e(t[o],o))return}function a(t,e){if(g(t)){for(var n=0;n<t.length;n++)if(e(n,t[n]))return!0}else{if(!w(t))return!1;for(var r in t)if(t.hasOwnProperty(r)&&e(r,t[r]))return!0}}function s(){var t,e=!1,n=0,r=arguments[n];if(_(r)&&(e=r,n++,r=arguments[n]),arguments.length>n+1&&(t=arguments[n+1]),g(r)){var o=[];return r.forEach((function(n,i){(null==t||t(r,i,n))&&o.push(e?s(e,n):n)})),o}if(w(r)){var i=p(r);return u(r,(function(n,o){(null==t||t(r,o,n))&&(i[o]=e?s(e,n):n)})),i}return r}function c(){var t=!1,e=0,n=arguments[e];_(n)&&(t=n,n=arguments[++e]),t?Array.prototype.slice.call(arguments,e+1).forEach((function(t){h(n,t)})):Array.prototype.slice.call(arguments,e+1).forEach((function(t){f(n,t)}))}function l(){var t=!1,e=0,n={};return _(arguments[e])&&(t=arguments[e],e++),t?Array.prototype.slice.call(arguments,e).forEach((function(t){h(n,t)})):Array.prototype.slice.call(arguments,e).forEach((function(t){f(n,t)})),n}function f(t,e){u(e,(function(e,n){t[n]=e}))}function h(t,e){u(e,(function(e,n){null==t[n]?t[n]=e:w(t[n])&&w(e)?h(t[n],e):t[n]=e}))}function p(t){function e(){}return e.prototype=t,new e}function y(t,e){!function(t,e){var n=p(e.prototype);n.constructor=t,t.prototype=n}(t,e),t.super=function(){e.apply(this,arguments)}}function d(t){return x(t)?t.toLowerCase():t}function b(t){return x(t)?t.toUpperCase():t}function v(t){return void 0===t}function m(t){return void 0!==t}function g(t){return t instanceof Array}function w(t){return null!==t&&"object"===r(t)}function k(t){return null!==t&&"object"===r(t)&&!i(t)}function x(t){return"string"==typeof t}function O(t){return"number"==typeof t}function E(t){return"[object Date]"===o.call(t)}function S(t){return"function"==typeof t}function j(t){return"[object RegExp]"===o.call(t)}function _(t){return"boolean"==typeof t}function C(t){return"undefined"!=typeof FormData&&t instanceof FormData}function P(t,e){var n=t===e;return n||(g(t)&&g(e)?t.length===e.length&&(n=!a(t,(function(t,n){return!P(n,e[t])}))):w(t)&&w(e)&&i(t)===i(e)&&(n=!a(t,(function(t,n){return!P(n,e[t])})))),n}function $(t){return!w(t)||!a(t,(function(){return!0}))}function N(t){console.log(t)}function T(t,e){return t.some((function(t){return t===e}))}function A(t,e,n){return t.some((function(t){return t===e||n&&d(t)===d(e)}))}function D(t,e,n){if(!t)return!1;for(var r,o=!0,i=e.split("."),a=t;o&&i.length>0;)r=i.shift(),o=!1,u(a,(function(t,e){return(o=e===r||n&&d(e)===d(r))&&(a=t),o}),!0);return o}function L(t,e,n){if(!t)return null;for(var r,o=!0,i=e.split("."),a=t;o&&i.length>0;)r=i.shift(),o=!1,u(a,(function(t,e){return(o=e===r||n&&d(e)===d(r))&&(a=t),o}),!0);return o?a:null}function I(t,e,n,r){if(t){for(var o,i=!0,a=e.split("."),s=t;i&&a.length>0;)o=a.shift(),0===a.length?s[o]=n:(i=!1,u(s,(function(t,e){return(i=e===o||r&&d(e)===d(o))&&(s=t),i}),!0));if(!i)throw new Error(e+": Can not set property of undefined")}}function V(){return Array.prototype.concat.apply([],arguments)}function R(t,e){var n=function(t){return null==e?t:e(t)};return t.sort((function(t,e){return n(t)<n(e)?-1:n(t)>n(e)?1:0}))}function M(t,e){var n=function(t){return null==e?t:e(t)};return t.sort((function(t,e){return n(t)<n(e)?1:n(t)>n(e)?-1:0}))}function B(t){var e=parseFloat(t);return isNaN(e)?t:e}function F(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}function U(){if(0!==arguments.length){for(var t,e,n="",r=arguments[0],o=/\{(\d+)\}/g,i=o.lastIndex;t=o.exec(r);){if(t[0],e=Number.parseInt(t[1])+1,arguments.length<=e)throw new Error("format item "+e+"is not defined");n+=r.substring(i,t.index)+arguments[e],i=o.lastIndex}return n+=r.substring(i)}}function q(t){return t.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&quote;/g,"")}function K(t,e){var n="",r=e.length;return e.forEach((function(e,o){n+=e,o+1<r&&(n+=t)})),n}var z=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$event=e,this.$element=n};function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var W=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data={},this.handlers=[]}var e,n,r;return e=t,(n=[{key:"on",value:function(t){var e=this;if(-1!==this.handlers.indexOf(t))throw new Error("can not register same event handler more than once");return this.handlers.push(t),function(){return e.off(t)}}},{key:"off",value:function(t){var e=this.handlers.indexOf(t);-1!==e&&this.handlers.splice(e,1)}},{key:"fire",value:function(t,e){var n=this;e=e||this,this.data=t||{},this.handlers.forEach((function(t){return t.call(e,n)}))}}])&&H(e.prototype,n),r&&H(e,r),t}(),Y={propertyChanged:new W,translateChanged:new W};function Z(t){return t instanceof W}var G=Symbol("__isProxy"),J=Symbol("__target"),Q={get:function(t,e){if(e===G)return!0;if(e===J)return t;return t[e]},set:function(t,e,n){var r=tt(t[e]),o=tt(n);r!==o?(t[e]=function t(e){if(w(e)&&!X(e))return u(e,(function(n,r){e[r]=t(n)})),new Proxy(e,Q);return e}(n),Y.propertyChanged.fire({target:t,key:e,data:{oldValue:r,newValue:o}})):t[e]!==n&&(t[e]=n);return!0}};function X(t){return w(t)&&t[G]}function tt(t){return X(t)?t[J]:t}Object.prototype.toProxy=function(){return X(this)?this:new Proxy(this,Q)};var et={isIdentifierContinue:!1,isIdentifierStart:!1,literals:{false:!1,null:null,true:!0,undefined:void 0}};var nt={Program:"Program",ExpressionStatement:"ExpressionStatement",AssignmentExpression:"AssignmentExpression",ConditionalExpression:"ConditionalExpression",LogicalExpression:"LogicalExpression",BinaryExpression:"BinaryExpression",UnaryExpression:"UnaryExpression",CallExpression:"CallExpression",MemberExpression:"MemberExpression",Identifier:"Identifier",Literal:"Literal",ArrayExpression:"ArrayExpression",Property:"Property",ObjectExpression:"ObjectExpression"},rt=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$null=!0};function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var it=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.childNodes=[]}var e,n,r;return e=t,(n=[{key:"appendChild",value:function(t){this.childNodes.push(t)}}])&&ot(e.prototype,n),r&&ot(e,r),t}();function ut(t){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function at(t,e){return!e||"object"!==ut(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lt=function(t){function e(t,n,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=at(this,st(e).call(this,nt.AssignmentExpression))).left=t,o.right=n,o.operator=r,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(e,t),e}(it);function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dt=function(t){function e(t,n,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ht(this,pt(e).call(this,nt.BinaryExpression))).operator=t,o.left=n,o.right=r,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}(e,t),e}(it);function bt(t){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){return!e||"object"!==bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gt(t,e){return(gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wt=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=vt(this,mt(e).call(this,nt.CallExpression))).callee=t,r.args=n,r.filter=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gt(t,e)}(e,t),e}(it);function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xt(t,e){return!e||"object"!==kt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ot(t){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var St=function(t){function e(t,n,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=xt(this,Ot(e).call(this,nt.ConditionalExpression))).test=t,o.alternate=n,o.consequent=r,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(e,t),e}(it);function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){return!e||"object"!==jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pt(t,e){return(Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_t(this,Ct(e).call(this,nt.ExpressionStatement))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(e,t),e}(it);function Nt(t){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){return!e||"object"!==Nt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function At(t){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dt(t,e){return(Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Tt(this,At(e).call(this,nt.Identifier))).name=t,n.allowNull=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dt(t,e)}(e,t),e}(it);function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vt(t,e){return!e||"object"!==It(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rt(t){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Vt(this,Rt(e).call(this,nt.Literal))).value=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(e,t),e}(it);function Ft(t){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,e){return!e||"object"!==Ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zt=function(t){function e(t,n,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ut(this,qt(e).call(this,nt.LogicalExpression))).operator=t,o.left=n,o.right=r,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kt(t,e)}(e,t),e}(it);function Ht(t){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wt(t,e){return!e||"object"!==Ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yt(t){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zt(t,e){return(Zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gt=function(t){function e(t,n,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Wt(this,Yt(e).call(this,nt.MemberExpression))).object=t,o.property=n,o.computed=r,o.allowNull=!1,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zt(t,e)}(e,t),e}(it);function Jt(t){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qt(t,e){return!e||"object"!==Jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xt(t){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function te(t,e){return(te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ee=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Qt(this,Xt(e).call(this,nt.ObjectExpression))).properties=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&te(t,e)}(e,t),e}(it);function ne(t){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function re(t,e){return!e||"object"!==ne(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oe(t){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ie(t,e){return(ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ue=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),re(this,oe(e).call(this,nt.Program))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ie(t,e)}(e,t),e}(it);function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function se(t,e){return!e||"object"!==ae(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ce(t){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function le(t,e){return(le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fe=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=se(this,ce(e).call(this,nt.Property))).kind="init",t.key=null,t.value=null,t.computed=!1,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&le(t,e)}(e,t),e}(it);function he(t){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pe(t,e){return!e||"object"!==he(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,e){return(de=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var be=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=pe(this,ye(e).call(this,nt.UnaryExpression))).prefix=!0,r.operator=t,r.arg=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&de(t,e)}(e,t),e}(it);function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function me(t,e){return!e||"object"!==ve(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ge(t){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function we(t,e){return(we=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ke=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),me(this,ge(e).call(this,nt.ArrayExpression))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&we(t,e)}(e,t),e}(it),xe={};function Oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}"+ - * / % === !== == != < > <= >= && || ! = |".split(" ").forEach((function(t){xe[t]=!0}));var Ee=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=l(et,e)}var e,n,r;return e=t,(n=[{key:"lex",value:function(t){for(this.text=t,this.index=0,this.tokens=[];this.index<this.text.length;){var e=this.text.charAt(this.index);if('"'===e||"'"===e)this.readString(e);else if(this.isNumber(e)||"."===e&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(e,"(){}[].,;:?"))this.tokens.push({index:this.index,text:e}),this.index++;else if(this.isWhitespace(e))this.index++;else{var n=e+this.peek(),r=n+this.peek(2),o=xe[e],i=xe[n],u=xe[r];if(o||i||u){var a=u?r:i?n:e;this.tokens.push({index:this.index,text:a,operator:!0}),this.index+=a.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens}},{key:"is",value:function(t,e){return-1!==e.indexOf(t)}},{key:"peek",value:function(t){var e=t||1;return this.index+e<this.text.length&&this.text.charAt(this.index+e)}},{key:"isNumber",value:function(t){return"0"<=t&&t<="9"&&"string"==typeof t}},{key:"isWhitespace",value:function(t){return" "===t||"\r"===t||"\t"===t||"\n"===t||"\v"===t||" "===t}},{key:"isIdentifierStart",value:function(t){return this.options.isIdentifierStart?this.options.isIdentifierStart(t,this.codePointAt(t)):this.isValidIdentifierStart(t)}},{key:"isValidIdentifierStart",value:function(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"||"_"===t||"$"===t}},{key:"isIdentifierContinue",value:function(t){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(t,this.codePointAt(t)):this.isValidIdentifierContinue(t)}},{key:"isValidIdentifierContinue",value:function(t,e){return this.isValidIdentifierStart(t,e)||this.isNumber(t)}},{key:"codePointAt",value:function(t){return 1===t.length?t.charCodeAt(0):(t.charCodeAt(0)<<10)+t.charCodeAt(1)-56613888}},{key:"peekMultichar",value:function(){var t=this.text.charAt(this.index),e=this.peek();if(!e)return t;var n=t.charCodeAt(0),r=e.charCodeAt(0);return n>=55296&&n<=56319&&r>=56320&&r<=57343?t+e:t}},{key:"isExpOperator",value:function(t){return"-"===t||"+"===t||this.isNumber(t)}},{key:"throwError",value:function(t,e,n){n=n||this.index;var r=m(e)?"s "+e+"-"+this.index+" ["+this.text.substring(e,n)+"]":" "+n;throw new Error("Lexer Error: "+t+" at column"+r+" in expression ["+this.text+"].")}},{key:"readNumber",value:function(){for(var t="",e=this.index;this.index<this.text.length;){var n=d(this.text.charAt(this.index));if("."===n||this.isNumber(n))t+=n;else{var r=this.peek();if("e"===n&&this.isExpOperator(r))t+=n;else if(this.isExpOperator(n)&&r&&this.isNumber(r)&&"e"===t.charAt(t.length-1))t+=n;else{if(!this.isExpOperator(n)||r&&this.isNumber(r)||"e"!==t.charAt(t.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:e,text:t,constant:!0,value:Number(t)})}},{key:"readIdent",value:function(){var t=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var e=this.peekMultichar();if(!this.isIdentifierContinue(e))break;this.index+=e.length}this.tokens.push({index:t,text:this.text.slice(t,this.index),identifier:!0})}},{key:"readString",value:function(t){var e=this.index;this.index++;for(var n="",r=t,o=!1;this.index<this.text.length;){var i=this.text.charAt(this.index);if(r+=i,o){if("u"===i){var u=this.text.substring(this.index+1,this.index+5);u.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+u+"]"),this.index+=4,n+=String.fromCharCode(parseInt(u,16))}else n+=ESCAPE[i]||i;o=!1}else if("\\"===i)o=!0;else{if(i===t)return this.index++,void this.tokens.push({index:e,text:r,constant:!0,value:n});n+=i}this.index++}this.throwError("Unterminated quote",e)}}])&&Oe(e.prototype,n),r&&Oe(e,r),t}();function Se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var je=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lexer=e,this.options=l(et,n)}var e,n,r;return e=t,(n=[{key:"throwError",value:function(t,e){throw new Error("Syntax Error: Token '"+e.text+"'"+t+" at column "+(e.index+1)+" of the expression ["+this.text+"] starting at ["+this.text.substring(e.index)+"].")}},{key:"parse",value:function(t){this.text=t,this.tokens=this.lexer.lex(t);var e=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),e}},{key:"program",value:function(){for(var t=new ue;;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&t.appendChild(this.expressionStatement()),!this.expect(";"))return t}},{key:"expressionStatement",value:function(){var t=new $t;return t.appendChild(this.filterChain()),t}},{key:"filterChain",value:function(){for(var t=this.expression();this.expect("|");)t=this.filter(t);return t}},{key:"expression",value:function(){return this.assignment()}},{key:"isAssignable",value:function(t){return t.type===nt.Identifier||t.type===nt.MemberExpression}},{key:"assignment",value:function(){var t=this.ternary();if(this.expect("=")){if(!this.isAssignable(t))throw new Error("Trying to assign a value to a non l-value");t=new lt(t,this.assignment(),"=")}return t}},{key:"ternary",value:function(){var t,e,n=this.logicalOR();return this.expect("?")&&(t=this.expression(),this.consume(":"))?(e=this.expression(),new St(n,t,e)):n}},{key:"logicalOR",value:function(){for(var t=this.logicalAND();this.expect("||");)t=new zt("||",t,this.logicalAND());return t}},{key:"logicalAND",value:function(){for(var t=this.equality();this.expect("&&");)t=new zt("&&",t,this.equality());return t}},{key:"equality",value:function(){for(var t,e=this.relational();t=this.expect("==","!=","===","!==");)e=new dt(t.text,e,this.relational());return e}},{key:"relational",value:function(){for(var t,e=this.additive();t=this.expect("<",">","<=",">=");)e=new dt(t.text,e,this.additive());return e}},{key:"additive",value:function(){for(var t,e=this.multiplicative();t=this.expect("+","-");)e=new dt(t.text,e,this.multiplicative());return e}},{key:"multiplicative",value:function(){for(var t,e=this.unary();t=this.expect("*","/","%");)e=new dt(t.text,e,this.unary());return e}},{key:"unary",value:function(){var t;return(t=this.expect("+","-","!"))?new be(t.text,this.unary()):this.primary()}},{key:"primary",value:function(){var t,e;for(this.expect("(")?(t=this.filterChain(),this.consume(")")):this.expect("[")?t=this.arrayDeclaration():this.expect("{")?t=this.object():this.options.literals.hasOwnProperty(this.peek().text)?t=new Bt(this.options.literals[this.consume().text]):this.peek().identifier?t=this.identifier():this.peek().constant?t=this.constant():this.throwError("not a primary expression",this.peek());this.peek("(","[",".")||this.peek("?")&&this.peekAhead(1,".");)this.expect("?")&&(t.allowNull=!0),"("===(e=this.expect("(","[",".")).text?(t=new wt(t,this.parseArguments()),this.consume(")")):"["===e.text?(t=new Gt(t,this.expression(),!0),this.consume("]")):"."===e.text?t=new Gt(t,this.identifier(),!1):this.throwError("IMPOSSIBLE");return t}},{key:"filter",value:function(t){for(var e=[t],n=[this.identifier()];this.expect(".");)n.push(this.identifier());var r=n.map((function(t){return t.name})).join("."),o=new wt(new Lt(r),e);for(o.filter=!0;this.expect(":");)e.push(this.expression());return o}},{key:"parseArguments",value:function(){var t=[];if(")"!==this.peekToken().text)do{t.push(this.filterChain())}while(this.expect(","));return t}},{key:"identifier",value:function(){var t=this.consume();return t.identifier||this.throwError("is not a valid identifier",t),new Lt(t.text)}},{key:"constant",value:function(){return new Bt(this.consume().value)}},{key:"arrayDeclaration",value:function(){var t=new ke;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;t.appendChild(this.expression())}while(this.expect(","));return this.consume("]"),t}},{key:"object",value:function(){var t,e=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;t=new fe,this.peek().constant?(t.key=this.constant(),t.computed=!1,this.consume(":"),t.value=this.expression()):this.peek().identifier?(t.key=this.identifier(),t.computed=!1,this.peek(":")?(this.consume(":"),t.value=this.expression()):t.value=t.key):this.peek("[")?(this.consume("["),t.key=this.expression(),this.consume("]"),t.computed=!0,this.consume(":"),t.value=this.expression()):this.throwError("invalid key",this.peek()),e.push(t)}while(this.expect(","));return this.consume("}"),new ee(e)}},{key:"consume",value:function(t){if(0===this.tokens.length)throw new Error("Unexpected end of expression: "+this.text);var e=this.expect(t);return e||this.throwError("is unexpected, expecting ["+t+"]",this.peek()),e}},{key:"peekToken",value:function(){if(0===this.tokens.length)throw new Error("Unexpected end of expression: "+this.text);return this.tokens[0]}},{key:"peek",value:function(t,e,n,r){return this.peekAhead(0,t,e,n,r)}},{key:"peekAhead",value:function(t,e,n,r,o){if(this.tokens.length>t){var i=this.tokens[t],u=i.text;if(u===e||u===n||u===r||u===o||!e&&!n&&!r&&!o)return i}return!1}},{key:"expect",value:function(t,e,n,r){var o=this.peek(t,e,n,r);return!!o&&(this.tokens.shift(),o)}}])&&Se(e.prototype,n),r&&Se(e,r),t}();function _e(t){return(new Ee).lex(t)}function Ce(t){return new je(new Ee).parse(t)}function Pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $e=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"build",value:function(t){var e;switch(t.type){case nt.ExpressionStatement:e=this.buildExpression(t);break;case nt.AssignmentExpression:e=this.buildAssignment(t);break;case nt.ConditionalExpression:e=this.buildCondition(t);break;case nt.LogicalExpression:e=this.buildLogic(t);break;case nt.BinaryExpression:e=this.buildBinary(t);break;case nt.UnaryExpression:e=this.buildUnary(t);break;case nt.CallExpression:e=this.buildCall(t);break;case nt.MemberExpression:e=this.buildMember(t);break;case nt.Identifier:e=this.buildIdentifier(t);break;case nt.Literal:e=this.buildLiteral(t);break;case nt.ArrayExpression:e=this.buildArray(t);break;case nt.Property:e=this.buildProperty(t);break;case nt.ObjectExpression:e=this.buildObject(t)}return e}},{key:"buildExpression",value:function(t){var e,n=this;return t.childNodes.forEach((function(t){e=n.build(t)})),e}},{key:"buildAssignment",value:function(t){return U("{0}={1}",this.build(t.left),this.build(t.right))}},{key:"buildCondition",value:function(t){return U("{0}?{1}:{2}",this.build(t.test),this.build(t.alternate),this.build(t.consequent))}},{key:"buildLogic",value:function(t){var e=this.build(t.left),n=this.build(t.right);return U("{0}{1}{2}",e,t.operator,n)}},{key:"buildBinary",value:function(t){var e=this.build(t.left),n=this.build(t.right);return U("{0}{1}{2}",e,t.operator,n)}},{key:"buildUnary",value:function(t){var e=this.build(t.arg);return U("{0}{1}",t.operator,e)}},{key:"buildCall",value:function(t){var e=this,n="",r=t.args.map((function(t){return e.build(t)})),o=this.build(t.callee);return t.filter?(r.length>0&&(n=r.shift()),n+=" | "+o,r.length>0&&(n+=":"+K(":",r))):n=U("{0}({1})",o,K(", ",r)),n}},{key:"buildMember",value:function(t){var e=this.build(t.object),n=this.build(t.property);return t.computed?U("{0}[{1}]",e,n):U("{0}.{1}",e,n)}},{key:"buildIdentifier",value:function(t){return t.name}},{key:"buildLiteral",value:function(t){return x(t.value)?U('"{0}"',t.value):t.value}},{key:"buildProperty",value:function(t){return U("{0}:{1}",this.build(t.key,{propertyKey:!0}),this.build(t.value))}},{key:"buildObject",value:function(t){var e=this;return U("{{0}}",K(", ",t.properties.map((function(t){return e.build(t)}))))}},{key:"buildArray",value:function(t){var e=this;return U("[{0}]",K(",",t.childNodes.map((function(t){return e.build(t)}))))}}])&&Pe(e.prototype,n),r&&Pe(e,r),t}();function Ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Te=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scope=e,this.options=l({allowNull:!1,assignInterceptor:null},n),this.program=null,this.locals=null,this.builder=new $e,this.parser=e.$parser||{parseExpression:Ce}}var e,n,r;return e=t,(n=[{key:"evaluate",value:function(t,e){var n=this.parser.parseExpression(t);return this.evaluateProgram(n,e)}},{key:"evaluateProgram",value:function(t,e){var n,r=this;return this.program=t,this.locals=e,this.program.childNodes.forEach((function(t){n=r.evaluateNode(t)})),n&&n.$null&&(n=null),n}},{key:"assign",value:function(t,e,n){var r=this.parser.parseExpression(t);return this.assignProgram(r,e,n)}},{key:"assignProgram",value:function(t,e,n){if(this.program=t,this.locals=n,1!==this.program.childNodes.length)throw new Error(U("{0} is not a valid assignment",exp));var r=this.program.childNodes[0];if(r.childNodes.length>1)throw new Error(U("{0} is not a valid assignment",exp));var o=r.childNodes[0];if(o.type===nt.MemberExpression){var i=this.evaluateNode(o.object);if(null==i)throw new Error(U("{0} is null or undefined",this.builder.build(o.object)));if(null==(u=this.evaluateNode(o.property,{propertyKey:!o.computed})))throw new Error(U("{0} is null or undefined",this.builder.build(o.property)));null==this.options.assignInterceptor?i[u]=e:this.options.assignInterceptor.call(this,i,u,e)}else{if(o.type!==nt.Identifier)throw new Error(U("{0} is not a valid assignment",exp));var u=this.builder.build(o);null==this.options.assignInterceptor?this.scope[u]=e:this.options.assignInterceptor.call(this,this.scope,u,e)}}},{key:"evaluateNode",value:function(t,e){var n;switch(t.type){case nt.ExpressionStatement:n=this.evaluateExpression(t);break;case nt.AssignmentExpression:n=this.evaluateAssignment(t);break;case nt.ConditionalExpression:n=this.evaluateCondition(t);break;case nt.LogicalExpression:n=this.evaluateLogic(t);break;case nt.BinaryExpression:n=this.evaluateBinary(t);break;case nt.UnaryExpression:n=this.evaluateUnary(t);break;case nt.CallExpression:n=this.evaluateCall(t);break;case nt.MemberExpression:n=this.evaluateMember(t,e);break;case nt.Identifier:n=this.evaluateIdentifier(t,e);break;case nt.Literal:n=this.evaluateLiteral(t);break;case nt.ArrayExpression:n=this.evaluateArray(t);break;case nt.Property:n=this.evaluateProperty(t);break;case nt.ObjectExpression:n=this.evaluateObject(t)}return n}},{key:"evaluateExpression",value:function(t){var e,n=this;return t.childNodes.forEach((function(t){e=n.evaluateNode(t)})),e}},{key:"evaluateAssignment",value:function(t){var e=this.evaluateNode(t.left,{assignmentLeft:!0}),n=this.evaluateNode(t.right);null==this.options.assignInterceptor?e.obj[e.prop]=n:this.options.assignInterceptor.call(this,e.obj,e.prop,n)}},{key:"evaluateCondition",value:function(t){return this.evaluateNode(t.test)?this.evaluateNode(t.alternate):this.evaluateNode(t.consequent)}},{key:"evaluateLogic",value:function(t){var e,n=this.evaluateNode(t.left),r=this.evaluateNode(t.right);switch(t.operator){case"&&":case"||":e=n&&r}return e}},{key:"evaluateBinary",value:function(t){var e,n=this.evaluateNode(t.left),r=this.evaluateNode(t.right);switch(t.operator){case"+":e=n+r;break;case"-":e=n-r;break;case"*":e=n*r;break;case"/":e=n/r;break;case"%":e=n%r;break;case"<":e=n<r;break;case">":e=n>r;break;case"<=":e=n<=r;break;case">=":e=n>=r;break;case"==":e=n==r;break;case"!=":e=n!=r;break;case"===":e=n===r;break;case"!==":e=n!==r}return e}},{key:"evaluateUnary",value:function(t){var e,n=this.evaluateNode(t.arg);switch(t.operator){case"+":e=n;break;case"-":e=-n;break;case"!":e=!n}return e}},{key:"evaluateCall",value:function(t){var e=this,n=t.args.map((function(t){return e.evaluateNode(t)})),r=this.evaluateNode(t.callee,{callee:!0});if(t.filter){var o=this.scope.$getFilter(r.prop);if(null==o)throw new Error('Filter "'+r.prop+'" is not defined');return o.execute.apply(o,n)}var i=r.obj[r.prop];if(S(i))return i.apply(r.obj,n);throw new Error(r.prop+" is not a function")}},{key:"evaluateMember",value:function(t,e){var n=this.evaluateNode(t.object);return null==n&&(this.options.allowNull||t.object.allowNull)&&(n=new rt),t.computed?n[this.evaluateNode(t.property)]:this.evaluateNode(t.property,{target:n,targetNode:t.object,callee:e&&e.callee,assignmentLeft:e&&e.assignmentLeft})}},{key:"evaluateIdentifier",value:function(t,e){var n;if(n=null==(e=e||{}).targetNode?this.scope:e.target,e.assignmentLeft||e.callee)return{obj:n,prop:t.name};if(e.propertyKey)return t.name;var r=n[t.name];return null==r&&this.locals&&(r=this.locals[t.name]),r}},{key:"evaluateLiteral",value:function(t){return t.value}},{key:"evaluateProperty",value:function(t){return{key:this.evaluateNode(t.key,{propertyKey:!0}),value:this.evaluateNode(t.value)}}},{key:"evaluateObject",value:function(t){var e=this,n={};return t.properties.forEach((function(t){var r=e.evaluateNode(t);n[r.key]=r.value})),n}},{key:"evaluateArray",value:function(t){var e=this,n=[];return t.childNodes.forEach((function(t){n.push(e.evaluateNode(t))})),n}}])&&Ne(e.prototype,n),r&&Ne(e,r),t}();function Ae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Le(t,e,n){return e&&De(t.prototype,e),n&&De(t,n),t}var Ie=function(){function t(e,n){Ae(this,t),this.callee=e,this.exp=n,this.children={}}return Le(t,[{key:"createChild",value:function(e,n,r){return this.children[e]||(this.children[e]=new t(n,r)),this.children[e]}}]),t}(),Ve=function(){function t(e){Ae(this,t),this.parser=e||{parseExpression:Ce},this.program=null,this.accessor={},this.builder=new $e}return Le(t,[{key:"createAccessor",value:function(t,e,n){return this.accessor[t]||(this.accessor[t]=new Ie(e,n)),this.accessor[t]}},{key:"analyse",value:function(t){var e=this.parser.parseExpression(t);return this.analyseProgram(e)}},{key:"analyseProgram",value:function(t){var e=this;return this.accessor={},this.program=t,t.childNodes.forEach((function(t){return e.analyseNode(t)})),this.accessor}},{key:"analyseNode",value:function(t,e){var n=null;switch(t.type){case nt.ExpressionStatement:this.analyseExpression(t);break;case nt.AssignmentExpression:this.analyseAssignment(t);break;case nt.ConditionalExpression:this.analyseCondition(t);break;case nt.LogicalExpression:this.analyseLogic(t);break;case nt.BinaryExpression:this.analyseBinary(t);break;case nt.UnaryExpression:this.analyseUnary(t);break;case nt.CallExpression:this.analyseCall(t);break;case nt.MemberExpression:n=this.analyseMember(t,e);break;case nt.Identifier:n=this.analyseIdentifier(t,e);break;case nt.Literal:n=this.analyseLiteral(t,e);break;case nt.ArrayExpression:this.analyseArray(t);break;case nt.Property:this.analyseProperty(t);break;case nt.ObjectExpression:this.analyseObject(t)}return n}},{key:"analyseExpression",value:function(t){var e=this;t.childNodes.forEach((function(t){return e.analyseNode(t)}))}},{key:"analyseAssignment",value:function(t){this.analyseNode(t.right)}},{key:"analyseCondition",value:function(t){this.analyseNode(t.test),this.analyseNode(t.alternate),this.analyseNode(t.consequent)}},{key:"analyseLogic",value:function(t){this.analyseNode(t.left),this.analyseNode(t.right)}},{key:"analyseBinary",value:function(t){this.analyseNode(t.left),this.analyseNode(t.right)}},{key:"analyseUnary",value:function(t){this.analyseNode(t.arg)}},{key:"analyseCall",value:function(t){var e=this;t.args.forEach((function(t){return e.analyseNode(t)})),t.filter||this.analyseNode(t.callee,{callee:!0})}},{key:"analyseMember",value:function(t,e){var n=this.analyseNode(t.object);if(t.computed){if(this.analyseNode(t.property,{callee:e&&e.callee}),t.property.type===nt.Literal)return n.createChild(t.property.value,e&&e.callee);var r=this.builder.build(t.property);return n.createChild(r,e&&e.callee,!0)}return this.analyseNode(t.property,{parent:n,callee:e&&e.callee})}},{key:"analyseIdentifier",value:function(t,e){var n=this.builder.build(t),r=e&&e.callee;return e&&e.parent?e.parent.createChild(n,r):this.createAccessor(n,r)}},{key:"analyseLiteral",value:function(t,e){var n=this.builder.build(t);if(e&&e.parent)return e.parent.createChild(n)}},{key:"analyseProperty",value:function(t){this.analyseNode(t.value)}},{key:"analyseObject",value:function(t){var e=this;t.properties.forEach((function(t){return e.analyseNode(t)}))}},{key:"analyseArray",value:function(t){var e=this;t.childNodes.forEach((function(t){return e.analyse(t)}))}}]),t}();function Re(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Be(t,e,n){return e&&Me(t.prototype,e),n&&Me(t,n),t}var Fe=function(){function t(e){Re(this,t),this.target=e,this.keys={}}return Be(t,[{key:"getHandlers",value:function(t){return this.keys[t]||(this.keys[t]=[]),this.keys[t]}},{key:"registerKey",value:function(t,e){this.getHandlers(t).push(e)}},{key:"unregisterKey",value:function(t,e){var n=this.getHandlers(t);if(null==e)n.length=0;else{var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},{key:"fireKey",value:function(t,e,n){this.getHandlers(t).forEach((function(t){t.call(n,e)}))}}]),t}(),Ue=function(){function t(){var e=this;Re(this,t),this.listeners=[],this.offPropertyChanged=Y.propertyChanged.on((function(t){return e.handlePropertyChanged(t.data)}))}return Be(t,[{key:"handlePropertyChanged",value:function(t){var e=this.getListener(this.listeners,t.target);null!=e&&(e.fireKey(t.key,t),e.fireKey("*",t))}},{key:"getListener",value:function(t,e){var n,r=t.filter((function(t){return t.target===e}));return r.length>0&&(n=r[0]),n}},{key:"createListener",value:function(t,e){var n=new Fe(e);return t.push(n),n}},{key:"getOrCreateListener",value:function(t,e){var n=this.getListener(t,e);return null==n&&(n=this.createListener(t,e)),n}},{key:"watch",value:function(t,e,n){var r=this.getOrCreateListener(this.listeners,tt(t));return r.registerKey(e,n),function(){r.unregisterKey(e,n)}}},{key:"destroy",value:function(){this.listeners.length=0,this.offPropertyChanged()}}]),t}();function qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ke=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.timeout=n,this.delayId=null}var e,n,r;return e=t,(n=[{key:"execute",value:function(t){var e=this;null==this.delayId&&(this.delayId=setTimeout((function(){e.delayId=null,e.handler.call(t)}),this.timeout))}},{key:"destroy",value:function(){null!=this.delayId&&clearTimeout(this.delayId)}}])&&qe(e.prototype,n),r&&qe(e,r),t}();function ze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function He(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function We(t,e,n){return e&&He(t.prototype,e),n&&He(t,n),t}var Ye=function(){function t(e,n,r){ze(this,t),this.exp=e,this.handler=n,this.value=r,this.newValue=r,this.valueChanged=!1,this.collectionChanged=!1}return We(t,[{key:"setNewValue",value:function(t){this.newValue=t,this.valueChanged=!0}},{key:"setCollectionChanged",value:function(t){this.collectionChanged=t}},{key:"hasChange",value:function(){return this.valueChanged||this.collectionChanged}},{key:"notify",value:function(t){var e=this.value,n=this.newValue,r=this.collectionChanged;this.value=this.newValue,this.collectionChanged=!1,this.handler.call(t,{oldValue:e,newValue:n,collectionChanged:r})}}]),t}(),Ze=function(){function t(e){ze(this,t),this.scope=e,this.accessors={},this.listeners=[],this.watcher=new Ue,this.analyser=new Ve(e.$parser),this.delayer=new Ke(this.notify,16),this.evaluator=new Te(this.scope,{allowNull:!0})}return We(t,[{key:"createListener",value:function(t,e,n){var r=new Ye(t,e,n);return this.listeners.push(r),r}},{key:"removeListener",value:function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)}},{key:"notify",value:function(){var t=this;this.listeners.forEach((function(e){e.hasChange()&&e.notify(t.scope)}))}},{key:"notifyChange",value:function(t,e){e?t.setNewValue(e):t.setCollectionChanged(!0),this.delayer.execute(this)}},{key:"getAccessor",value:function(t){var e=this.accessors[t];return e||(e=this.analyser.analyse(t),this.accessors[t]=e),s(!0,e)}},{key:"watch",value:function(t,e,n){var r=this,o=this.getAccessor(t),i=this.evaluator,a=this.createListener(t,e,i.evaluate(t,n));function s(t){u(t,(function(t){S(t.unwatch)&&(t.unwatch.call(this),t.unwatch=null),s(t.children)}))}return function e(o,c){w(c)&&u(o,(function(o,u){var l=c;o.exp&&(u=i.evaluate(u,n)),l===r.scope&&n&&n[u]&&(l=n),o.unwatch=r.watcher.watch(l,u,(function(u){s(o.children),e(o.children,u.data.newValue),r.notifyChange(a,i.evaluate(t,n))})),e(o.children,l[u])}))}(o,this.scope),function(){s(o),r.removeListener(a)}}},{key:"watchCollection",value:function(t,e,n){var r=arguments,o=this,i=this,u=this.evaluator,a=l(),s=this.watch(t,(function(){null!=a&&a.call(o),a=l(),e.apply(o,r)}),n),c=this.createListener(t,e,u.evaluate(t,n));function l(){var e=u.evaluate(t,n);if(w(e)||g(e))return i.watcher.watch(e,"*",(function(){i.notifyChange(c)}))}return function(){s.call(this),a&&a.call(this),i.removeListener(c)}}},{key:"destroy",value:function(){this.delayer.destroy(),this.watcher.destroy(),this.scope=null,this.listeners.length=0}}]),t}();function Ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Je={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entity:6,processingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Qe=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodeType=e,this.nodeName=n,this.nodeValue=r,this.childNodes=[],this.firstChild=null,this.lastChild=null,this.parentNode=null,this.previousSibling=null,this.nextSibling=null,this.nodeData={}}var e,n,r;return e=t,(n=[{key:"pushChild",value:function(t){t.parentNode=this,this.childNodes.push(t)}},{key:"buildSibling",value:function(){if(0!==this.childNodes.length){var t=this;1===this.childNodes.length?(this.firstChild=this.childNodes[0],this.lastChild=this.childNodes[0]):(this.firstChild=this.childNodes[0],this.lastChild=this.childNodes[this.childNodes.length-1],this.childNodes.forEach((function(e,n){0!==n?n!==t.childNodes.length-1?(e.previousSibling=t.childNodes[n-1],e.nextSibling=t.childNodes[n+1]):e.previousSibling=t.childNodes[n-1]:e.nextSibling=t.childNodes[n+1]}))),this.childNodes.forEach((function(t){t.buildSibling()}))}}},{key:"clearParentAndSibling",value:function(){this.parentNode=null,this.previousSibling=null,this.nextSibling=null}},{key:"remove",value:function(){null!=this.parentNode&&this.parentNode.removeChild(this)}},{key:"hasChildNodes",value:function(){return 0!==this.childNodes.length}},{key:"clearChildNodes",value:function(){this.childNodes.forEach((function(t){t.destroy()})),this.childNodes.length=0}},{key:"appendChild",value:function(t){return null!=t.parentNode&&t.parentNode.removeChild(t),t.parentNode=this,0===this.childNodes.length?this.firstChild=t:(this.lastChild.nextSibling=t,t.previousSibling=this.lastChild),t.compile(this.compileOptions),this.lastChild=t,this.childNodes.push(t),t}},{key:"insertBefore",value:function(t,e){null!=e.parentNode&&e.parentNode.removeChild(e);var n=this.childNodes.indexOf(t);if(-1===n)throw new Error("Ref node is not a child of specified node");return e.parentNode=this,null!=t.previousSibling&&(e.previousSibling=t.previousSibling,t.previousSibling.nextSibling=e),e.nextSibling=t,t.previousSibling=e,0===n&&(this.firstChild=e),e.compile(this.compileOptions),this.childNodes.splice(n,0,e),e}},{key:"insertAfter",value:function(t,e){return null==t.nextSibling?this.appendChild(e):this.insertBefore(t.nextSibling,e)}},{key:"removeChild",value:function(t){var e=this.childNodes.indexOf(t);if(-1===e)throw new Error("Remove node is not a child of specified node");return null!=t.previousSibling&&(t.previousSibling.nextSibling=t.nextSibling),null!=t.nextSibling&&(t.nextSibling.previousSibling=t.previousSibling),0===e&&(this.firstChild=t.nextSibling),e===this.childNodes.length-1&&(this.lastChild=t.previousSibling),t.clearParentAndSibling(),this.childNodes.splice(e,1),t}},{key:"replaceChild",value:function(t,e){null!=e.parentNode&&e.parentNode.removeChild(e);var n=this.childNodes.indexOf(t);if(-1===n)throw new Error("Ref node is not a child of specified node");return e.parentNode=this,e.previousSibling=t.previousSibling,e.nextSibling=t.nextSibling,this.firstChild===t&&(this.firstChild=e),this.lastChild===t&&(this.lastChild=e),t.clearParentAndSibling(),e.compile(this.compileOptions),this.childNodes.splice(n,1,e),e}},{key:"cloneNode",value:function(t){var e=this.onCloneNode(t);return t&&(e.childNodes=this.childNodes.map((function(e){return e.cloneNode(t)})),e.buildSibling()),e}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy(),this.childNodes.map((function(t){t.destroy()})),this.remove(),this.clearParentAndSibling(),this.childNodes.length=0,this.firstChild=null,this.lastChild=null,this.ownerDocument=null}}])&&Ge(e.prototype,n),r&&Ge(e,r),t}();function Xe(t){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function en(t,e){return!e||"object"!==Xe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nn(t){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rn(t,e){return(rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var on=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=en(this,nn(e).call(this,Je.attribute,t,n))).velm=null,r.quote='"',r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rn(t,e)}(e,t),n=e,(r=[{key:"setValue",value:function(t){this.nodeValue=t}},{key:"onCloneNode",value:function(){return new e(this.nodeName,this.nodeValue)}},{key:"onDestroy",value:function(){}}])&&tn(n.prototype,r),o&&tn(n,o),e}(Qe);function un(t){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function an(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sn(t,e){return!e||"object"!==un(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cn(t){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ln(t,e){return(ln=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),sn(this,cn(e).call(this,Je.comment,"#comment",t))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ln(t,e)}(e,t),n=e,(r=[{key:"onCloneNode",value:function(){return new e(this.nodeName,this.nodeValue)}}])&&an(n.prototype,r),o&&an(n,o),e}(Qe);function hn(t){return(hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yn(t,e){return!e||"object"!==hn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dn(t){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bn(t,e){return(bn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yn(this,dn(e).call(this,t))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bn(t,e)}(e,t),n=e,(r=[{key:"isValidIdentifierStart",value:function(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"||"_"===t||"$"===t||"@"===t||":"===t||"*"===t}},{key:"isValidIdentifierContinue",value:function(t,e){return this.isValidIdentifierStart(t,e)||this.isNumber(t)||"-"===t||"."===t}},{key:"expectString",value:function(t){var e=t.length;return this.index+e<=this.text.length&&t===this.text.substr(this.index,e)}},{key:"readComment",value:function(t,e){var n=this.index;this.index+=t.length;for(var r="",o=t;this.index<this.text.length;){var i=this.text.charAt(this.index);if(o+=i,this.expectString(e))return o+=e,this.index+=e.length,void this.tokens.push({index:n,text:o,comment:!0,value:r});r+=i,this.index++}this.throwError("Unterminated comment",n)}},{key:"readText",value:function(){for(var t=this.index,e="";this.index<this.text.length;){var n=this.text.charAt(this.index),r=this.peek();if("<"===n&&(this.isIdentifierStart(r)||"/"===r)||this.expectString("\x3c!--"))break;e+=n,this.index++}this.tokens.push({index:t,text:e,textTag:!0})}},{key:"readTag",value:function(t,e,n,r){for(this.tokens.push({index:this.index,text:t,tag:!0,closing:n,begin:!0,doctype:r}),this.index+=t.length,this.readIdent();this.index<this.text.length;){var o=this.text.charAt(this.index);if(!n){var i=o+this.peek();if(i==="/"+e){this.tokens.push({index:this.index,text:i,tag:!0,closing:!0,end:!0}),this.index+=i.length;break}}if(o===e){this.tokens.push({index:this.index,text:e,tag:!0,closing:!!r||n,end:!0}),this.index+=e.length;break}this.isIdentifierStart(this.peekMultichar())?this.readIdent():'"'===o||"'"===o?this.readString(o):this.isWhitespace(o)?this.index++:"="===o?(this.tokens.push({index:this.index,text:"=",equal:!0}),this.index++):this.throwError("Unexpected next character ",this.index,this.index+1)}}},{key:"lex",value:function(t){this.text=t,this.index=0,this.tokens=[];for(var e=!!this.options.allowDocType;this.index<this.text.length;){var n=this.text.charAt(this.index),r=this.peek(),o=this.peek(2);this.expectString("\x3c!--")?this.readComment("\x3c!--","--\x3e"):"<"===n&&this.isIdentifierStart(r)?this.readTag("<",">",!1):this.expectString("</")&&this.isIdentifierStart(o)?this.readTag("</",">",!0):this.expectString("<!DOCTYPE")?e?this.readTag("<!",">",!0,!0):this.throwError("DOCTYPE is not allowed",this.index,this.index+1):this.readText()}return this.tokens}}])&&pn(n.prototype,r),o&&pn(n,o),e}(Ee);function mn(t){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wn(t,e){return!e||"object"!==mn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kn(t){return(kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xn(t,e){return(xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var On=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wn(this,kn(e).call(this,t,n))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xn(t,e)}(e,t),n=e,(r=[{key:"parse",value:function(t){this.index=0,this.text=t,this.tokens=this.lexer.lex(t);for(var e,n=new Vn,r=!!this.options.allowDocType;this.index<this.tokens.length;){var o=this.current();if(o.doctype)r?e?this.throwError("DOCTYPE only allow one",o):(e=this.doctype(),n.childNodes.push(e)):this.throwError("DOCTYPE is not allowed",o);else if(o.comment){var i=new fn(o.text);n.childNodes.push(i),this.next()}else o.textTag?(t=new qn(o.text),n.childNodes.push(t),this.next()):o.tag&&o.begin?n.childNodes.push(this.element()):this.throwError("impossible",o)}return n.buildSibling(),n.childNodes}},{key:"doctype",value:function(){this.next();var t=new Yn,e=this.current();return e.identifier?t.nodeValue=e.text:this.throwError(" Unexpected ",e),this.attrs(t).forEach((function(e){t.childNodes.push(e)})),(e=this.current()).tag&&e.end&&e.closing?this.next():this.throwError(" Unexpected ",e),t}},{key:"element",value:function(t){this.next();var e=new Vn,n=this.current();if(n.identifier?(e.nodeName=n.text,this.next()):this.throwError(" Unexpected ",n),this.attrs(e).forEach((function(t){e.pushAttr(t)})),(n=this.current()).tag&&n.end){if(this.next(),"input"===e.nodeName)return e.selfClosed=!0,e;n.closing||this.childElements(e).forEach((function(t){e.pushChild(t)}))}else this.throwError(" Unexpected ",n);return(n=this.current()).tag&&n.begin&&n.closing?(this.next(),(n=this.current()).identifier&&e.nodeName===n.text?(this.next(),(n=this.current()).tag&&n.end&&n.closing?this.next():this.throwError(" Unexpected ",n)):this.throwError(" Unexpected ",n)):this.throwError(" Unexpected ",n),e}},{key:"childElements",value:function(t){for(var e=[];this.index<this.tokens.length;){var n=this.current();if(n.tag&&n.closing)break;if(n.comment){var r=new fn(n.text);e.push(r),this.next()}else if(n.textTag){var o=new qn(n.text);e.push(o),this.next()}else n.tag&&n.begin?e.push(this.element(t)):this.throwError(" Unexpected ",n)}return e}},{key:"attrs",value:function(t){for(var e=[];this.index<this.tokens.length;){var n=this.current();if(n.tag&&n.end)break;var r=new on;n.identifier&&(r.nodeName=n.text,r.origin=n.text,this.next(),(n=this.current()).equal&&(this.next(),(n=this.current()).constant?(r.nodeValue=n.value,this.next()):this.throwError(" Unexpected ",n))),e.push(r)}return e}},{key:"current",value:function(){return this.index<this.tokens.length?this.tokens[this.index]:{}}},{key:"next",value:function(){this.index++}}])&&gn(n.prototype,r),o&&gn(n,o),e}(je);function En(t){return t=q(t),(new vn).lex(t)}function Sn(t){return t=q(t),new On(new vn).parse(t)}function jn(t){return t.nodeType===Je.element}function _n(t){return t.nodeType===Je.attribute}function Cn(t){return t.nodeType===Je.text}function Pn(t){return t.nodeType===Je.comment}function $n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Nn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"build",value:function(t){return Cn(t)?this.buildText(t):Pn(t)?this.buildComment(t):this.buildElement(t)}},{key:"buildElement",value:function(t){var e=this,n=t.vattrs.map((function(t){return e.buildAttribute(t)})).join(" "),r=t.childNodes.map((function(t){return e.build(t)})).join("");n&&(n=" "+n);var o="<"+t.nodeName+n+">"+r;return t.selfClosed||(o+="</"+t.nodeName+">"),o}},{key:"buildAttribute",value:function(t){return t.nodeName+(null==t.nodeValue?"":"="+t.quote+t.nodeValue+t.quote)}},{key:"buildText",value:function(t){return t.nodeValue}},{key:"buildComment",value:function(t){return t.nodeValue}}])&&$n(e.prototype,n),r&&$n(e,r),t}();function Tn(t){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function An(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dn(t,e){return!e||"object"!==Tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ln(t){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function In(t,e){return(In=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Dn(this,Ln(e).call(this,Je.element,t))).elm=null,n.vattrs=[],n.selfClosed=!1,n.builder=new Nn,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&In(t,e)}(e,t),n=e,(r=[{key:"pushAttr",value:function(t){t.velm=this,this.vattrs.push(t)}},{key:"hasAttr",value:function(){return 0!==this.vattrs.length}},{key:"getAttr",value:function(t){var e=this.vattrs.filter((function(e){return e.nodeName===t}));return e.length?e[0]:null}},{key:"setAttr",value:function(t,e){var n,r=this.vattrs.filter((function(e){return e.belongTo(t)}));return r.length>0?(n=r[0]).setValue(e):((n=new on(t,e)).velm=this,n.compile(this.compileOptions)),this.vattrs.push(n),n}},{key:"removeAttr",value:function(t){var e=[],n=this;if(t instanceof on){var r=this.vattrs.indexOf(t);-1!==r&&(e=n.vattrs.splice(r,1))}else this.vattrs.filter((function(e){return e.belongTo(t)})).forEach((function(t){var r=n.vattrs.indexOf(t);t.destroy(),e=n.vattrs.splice(r,1)}));return e.length>0?e[0]:null}},{key:"appendAttr",value:function(t){if(null!=t.velm)throw new Error("Current attribute is not new!");return t.velm=this,t.compile(this.compileOptions),this.vattrs.push(t),t}},{key:"getOuterTpl",value:function(){return this.builder.build(this)}},{key:"getInnerTpl",value:function(){var t=this;return this.childNodes.map((function(e){return t.builder.build(e)})).join("")}},{key:"setOuterTpl",value:function(t){var e=this;Sn(t).forEach((function(t){t.parentNode=null,e.parentNode.insertBefore(e,t)})),e.parentNode.removeChild(e)}},{key:"setInnerTpl",value:function(t){var e=this;this.clearChildNodes(),Sn(t).forEach((function(t){t.parentNode=null,e.appendChild(t)}))}},{key:"onCloneNode",value:function(){var t=new e(this.nodeName,this.nodeValue);return t.vattrs=this.vattrs.map((function(e){var n=e.cloneNode();return n.velm=t,n})),t}},{key:"onDestroy",value:function(){this.vattrs.forEach((function(t){t.destroy()})),this.vattrs.length=0}}])&&An(n.prototype,r),o&&An(n,o),e}(Qe);function Rn(t){return(Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bn(t,e){return!e||"object"!==Rn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fn(t){return(Fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){return(Un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Bn(this,Fn(e).call(this,Je.text,"#text",t))).elm=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Un(t,e)}(e,t),n=e,(r=[{key:"onCloneNode",value:function(){return new e(this.nodeName,this.nodeValue)}}])&&Mn(n.prototype,r),o&&Mn(n,o),e}(Qe);function Kn(t){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zn(t,e){return!e||"object"!==Kn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hn(t){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wn(t,e){return(Wn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),zn(this,Hn(e).call(this,Je.documentType))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wn(t,e)}(e,t),e}(Qe);function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Gn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=e,this.program=null,this.unwatch=null,this.hasTranslation=!1}var e,n,r;return e=t,(n=[{key:"compute",value:function(t,e){return t.$eval(this.text,e)}},{key:"assign",value:function(t,e,n){t.$assign(this.text,e,n)}},{key:"watch",value:function(t,e,n){this.unwatch=t.$watch(this.text,e,n)}},{key:"destroy",value:function(){null!=this.unwatch&&this.unwatch()}}])&&Zn(e.prototype,n),r&&Zn(e,r),t}();function Jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Qn,Xn,tr=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scope=e,this.text=n,this.locals=r,this.isExp=!1,this.logical=!1,this.assignment=!1,this.automation=null,this.value=null,this.oldValue=null,this.changed=!1,this.segments=[],this.expressions=[]}var e,n,r;return e=t,(n=[{key:"createExpression",value:function(t){var e=new Gn(t);return this.expressions.push(e),e}},{key:"compile",value:function(){if((this.logical||this.assignment)&&(this.isExp=!0),this.isExp)this.createExpression(this.text);else{for(var t,e=/{{([^}]*)}}/g,n=e.lastIndex,r=e.exec(this.text);null!=r;)r.index>n&&(t=this.text.substring(n,r.index),this.segments.push(t)),this.segments.push(this.createExpression(r[1])),n=e.lastIndex,r=e.exec(this.text);this.text.length>n&&(t=this.text.substring(n),this.segments.push(t))}}},{key:"link",value:function(){var t=this;this.assignment||this.logical||(this.detect(),this.expressions.forEach((function(e){e.watch(t.scope,(function(){t.detect(),t.patch()}),t.locals)})))}},{key:"detect",value:function(){var t=this.compute();this.value!=t&&(this.changed=!0,this.oldValue=this.value,this.value=t)}},{key:"compute",value:function(t){var e=this;return t=l(this.locals,t),this.isExp?this.expressions[0].compute(this.scope,t):this.segments.reduce((function(n,r){return x(r)?n+r:n+(r.compute(e.scope,t)||"")}),"")}},{key:"assign",value:function(t,e){if(e=l(this.locals,e),!this.isExp)throw new Error(this.text+" is not valid expression");this.expressions[0].assign(this.scope,t,e)}},{key:"registerAutomation",value:function(t){this.automation=t}},{key:"unregisterAutomation",value:function(t){this.automation===t&&(this.automation=null)}},{key:"patch",value:function(){this.changed&&null!=this.automation&&(this.changed=!1,this.automation.call(this,this.value,this.oldValue))}},{key:"evaluate",value:function(t,e){return e=l(this.locals,e),this.scope.$eval(t,e)}},{key:"destroy",value:function(){this.expressions.forEach((function(t){t.destroy()}))}}])&&Jn(e.prototype,n),r&&Jn(e,r),t}();function er(t){return Array.prototype.slice.call(t.childNodes,0)}function nr(t,e){var n=t.parentNode;null!=n&&(n.insertBefore(e,t),n.removeChild(t))}function rr(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(/\s+/).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var n=" "+(t.getAttribute("class")||"")+" ";n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function or(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(/\s+/).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var n=" "+(t.getAttribute("class")||"")+" ",r=" "+e+" ";n.indexOf(r)>=0;)n=n.replace(r," ");(n=n.trim())?t.setAttribute("class",n):t.removeAttribute("class")}}Qn=".m-component{display:inherit;} .m-hide{display:none !important;}",(Xn=document.createElement("style")).appendChild(document.createTextNode(Qn)),document.getElementsByTagName("head")[0].appendChild(Xn);function ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ur(t,e,n){return e&&ir(t.prototype,e),n&&ir(t,n),t}var ar="load unload change submit reset select blur focus abort keydown keypress keyup click dblclick mousedown mousemove mouseout mouseover mouseup".split(" "),sr=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scope=e,this.template=n,this.locals=r,this.elms=[],this.vnodes=[],this.type={components:{},directives:{}},this.entity={bindings:[],components:[],directives:[]},this.parser=e.$parser}return ur(t,[{key:"injector",get:function(){return this.scope.$injector}},{key:"nsAlias",get:function(){return this.scope.$data.alias}},{key:"view",get:function(){var t=document.createDocumentFragment();return this.elms.forEach((function(e){return t.appendChild(e)})),t}}]),ur(t,[{key:"newBinding",value:function(t){var e=new tr(this.scope,t,this.locals);return this.entity.bindings.push(e),e}},{key:"newComponent",value:function(t){var e=this.injector.createComponent(t);return this.scope.$appendChild(e),this.entity.components.push(e),e}},{key:"newDirective",value:function(t){var e=this.injector.createDirective(t);return e.$$scope=this.scope,e}},{key:"recognizeComponent",value:function(t){var e,n,r=t.nodeName,o=this.type.components;return void 0!==o[r]?n=o[r]:(e=this.injector.parseFullName(r,this.nsAlias),n=this.injector.getComponent(e.key,e.ns),o[r]=n),n}},{key:"recognizeDirective",value:function(t){var e,n,r=t.nodeData.name,o=this.type.directives;return void 0!==o[r]?n=o[r]:(e=this.injector.parseFullName(r,this.nsAlias),n=this.injector.getDirective(e.key,e.ns),o[r]=n),n}},{key:"bindTranslateChanged",value:function(){var t=this.entity.bindings;t.length&&(this.unbindTranslateChanged=Y.translateChanged.on((function(){t.forEach((function(t){t.detect(),t.patch()}))})))}},{key:"render",value:function(){var t=this,e=document.createDocumentFragment();return this.vnodes=this.parser.parseTemplate(this.template),this.compileNodes(this.vnodes),this.linkNodes(this.vnodes).forEach((function(t){return e.appendChild(t)})),this.entity.directives.forEach((function(t){return t.$postlink()})),er(e).forEach((function(e){return t.elms.push(e)})),this.bindTranslateChanged(),e}},{key:"compileNodes",value:function(t){var e=this;t.forEach((function(t){return e.compileNode(t)}))}},{key:"compileNode",value:function(t){Cn(t)?this.compileText(t):Pn(t)?this.compileComment(t):this.compileElm(t)}},{key:"linkNodes",value:function(t){var e=this;return t.map((function(t){return e.linkNode(t)}))}},{key:"linkNode",value:function(t){return Cn(t)?this.linkText(t):Pn(t)?this.linkComment(t):this.linkElm(t)}},{key:"compileElm",value:function(t){var e=this,n=t.nodeData;n.component=this.recognizeComponent(t);var r=[],o=t.vattrs.some((function(t){var o=t.nodeData;return e.compileAttr(t),null!=o.directive&&(r.push(o.directive),n.linker=o.linker,null!=n.linker)}));R(r,(function(t){return t.$priority})).forEach((function(t){return e.entity.directives.push(t)})),n.directives=r,o||(n.component?n.slots=this.seekSlot(t):this.compileNodes(t.childNodes))}},{key:"compileAttr",value:function(t){var e,n=t.nodeName,r=t.nodeValue,o=t.nodeData;if(null!=r&&(e=this.newBinding(r),o.binding=e),n.startsWith("@")?(o.isEvent=!0,o.name=n.substr(1),o.isDomEvent=T(ar,o.name),e&&(e.logical=!0)):n.startsWith(":")?(o.name=n.substr(1),e&&(e.isExp=!0)):n.startsWith("*")?(o.directive=!0,o.name=n.substr(1),e&&(e.isExp=!0)):o.name=n,o.directive){var i=this.recognizeDirective(t);if(!i)throw new Error("directive "+o.name+" is not defined");if(o.directive=this.newDirective(i),o.directive.$$vattr=t,null!=e&&(e.assignment=o.directive.$assignment),o.directive.$compile())return void(o.linker=o.directive)}if(null!=e){if(!o.isEvent&&!o.directive){var u=function(e){var n=t.velm.elm;o.name.startsWith("style")?I(n,o.name,e):n.setAttribute(o.name,e)};t.velm.nodeData.component?e.registerAutomation((function(e){var n=t.velm.nodeData.component;n.$hasProperty(o.name)?n.$setProperty(o.name,e):u(e)})):e.registerAutomation(u)}e.compile()}}},{key:"compileText",value:function(t){t.nodeData.binding=this.newBinding(t.nodeValue),t.nodeData.binding.registerAutomation((function(e){var n,r=document.createTextNode(e);null==t.parentNode?null!=t.elm&&(n=t.elm.parentNode):n=t.parentNode.elm,null!=n&&(null==t.elm?n.appendChild(r):nr(t.elm,r)),t.elm=r})),t.nodeData.binding.compile()}},{key:"compileComment",value:function(t){}},{key:"linkElm",value:function(t){var e=this,n=t.nodeData;if(null!=n.linker)return n.linker.$link();if(t.elm=document.createElement(t.nodeName),n.component){var r=this.newComponent(n.component);n.component=r,rr(t.elm,"m-component"),t.vattrs.forEach((function(t){return e.linkAttr(t)})),r.$$velm=t,r.$setSlot(n.slots),r.$render(),r.$mount(t.elm)}else t.vattrs.forEach((function(t){return e.linkAttr(t)})),t.childNodes.forEach((function(n){return t.elm.appendChild(e.linkNode(n))}));return t.elm}},{key:"linkAttr",value:function(t){var e=t.velm,n=e.elm,r=t.nodeData,o=r.binding;null!=o&&(r.isEvent?r.isDomEvent?n.addEventListener(r.name,(function(t){return o.compute(new z(t,n))})):e.nodeData.component&&e.nodeData.component.$bind(r.name,(function(t){return o.compute(new z(t,n))})):(o.link(),o.patch()),r.directive&&o.registerAutomation((function(t,e){return r.directive.$change(t,e)})))}},{key:"linkText",value:function(t){return t.nodeData.binding.link(),t.elm=document.createTextNode(t.nodeData.binding.value),t.elm}},{key:"linkComment",value:function(t){return document.createComment(t.nodeValue)}},{key:"seekSlot",value:function(t){var e={};return t.childNodes.forEach((function(t){if(jn(t)){var n=t.getAttr("slot");n&&(e[n.nodeValue]=t.getInnerTpl())}})),e}},{key:"destroy",value:function(){this.unbindTranslateChanged(),this.entity.components.forEach((function(t){return t.$destroy()})),this.entity.directives.forEach((function(t){return t.$destroy()})),this.entity.bindings.forEach((function(t){return t.destroy()})),this.vnodes.forEach((function(t){return t.destroy()})),this.entity.components.length=0,this.entity.directives.length=0,this.entity.bindings.length=0,this.vnodes.length=0}}]),t}(),cr=0,lr=1,fr=2,hr=3;function pr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var yr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.programs={}}var e,n,r;return e=t,(n=[{key:"parseExpression",value:function(t){var e=this.programs[t];return e||(e=Ce(t),this.programs[t]=e),e}},{key:"parseTemplate",value:function(t){return Sn(t)}},{key:"destroy",value:function(){}}])&&pr(e.prototype,n),r&&pr(e,r),t}();function dr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var br=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.classContainer={},this.instanceContainer={},this.serviceStack=[]}var e,n,r;return e=t,(n=[{key:"getClassContainer",value:function(t){return this.classContainer[t]||(this.classContainer[t]={}),this.classContainer[t]}},{key:"getInstanceContainer",value:function(t){return this.instanceContainer[t]||(this.instanceContainer[t]=[]),this.instanceContainer[t]}},{key:"register",value:function(t,e,n){if(-1!==e.indexOf("."))throw new Error('Illegal character "."');var r=this.getClassContainer(t);if(null==r[e])r[e]=[];else{var o=r[e].filter((function(t){return t.prototype.$$metadata.namespace===n.prototype.$$metadata.namespace}));if(o.length>0)throw new Error(e+" is exist under namespace "+o[0].prototype.$$metadata.namespace)}r[e].push(n)}},{key:"registerComponent",value:function(t,e,n){this.register(fr,t,e,n)}},{key:"registerDirective",value:function(t,e,n){this.register(hr,t,e,n)}},{key:"registerFilter",value:function(t,e,n){this.register(cr,t,e,n)}},{key:"registerService",value:function(t,e,n){this.register(lr,t,e,n)}},{key:"has",value:function(t,e,n,r){var o,i=this.getClassContainer(t);return null!=(o=n?L(i,e,!0):i[e])&&!(r&&o.length>0&&0===(o=o.filter((function(t){var e=t.prototype.$$metadata;return e.namespace&&d(e.namespace)===d(r)}))).length)}},{key:"hasComponent",value:function(t,e){return this.has(fr,t,!0,e)}},{key:"hasDirective",value:function(t,e){return this.has(hr,t,!0,e)}},{key:"hasFilter",value:function(t,e){return this.has(cr,t,!0,e)}},{key:"hasService",value:function(t,e){return this.has(lr,t,!0,e)}},{key:"get",value:function(t,e,n,r){var o,i=this.getClassContainer(t);if(null==(o=n?L(i,e,!0):i[e]))return null;if(r&&o.length>0&&0===(o=o.filter((function(t){var e=t.prototype.$$metadata;return e.namespace&&d(e.namespace)===d(r)}))).length)return null;if(o.length>1){var u=o.map((function(t){return t.prototype.$$metadata.namespace}));throw new Error("namespace "+u.join("|")+" all have "+e)}return o[0]}},{key:"getComponent",value:function(t,e){return this.get(fr,t,e)}},{key:"getDirective",value:function(t,e){return this.get(hr,t,e)}},{key:"getFilter",value:function(t,e){return this.get(cr,t,e)}},{key:"getService",value:function(t,e){return this.get(lr,t,e)}},{key:"create",value:function(t,e,n){var r;if(x(e)){if(null==(r=this.get(t,e,n)))throw new Error("miss constructor for key "+e)}else{if(!S(e))throw new Error("Invalid parameter");r=e}return new r}},{key:"createComponent",value:function(t,e){return this.create(fr,t,e)}},{key:"createDirective",value:function(t,e){return this.create(hr,t,e)}},{key:"createFilter",value:function(t,e){var n,r=this.getInstanceContainer(cr);x(t)&&(t=this.getFilter(t,e));var o=r.filter((function(e){return e instanceof t}));return o.length?n=o[0]:(n=new t,r.push(n)),n}},{key:"createService",value:function(t,e){var n,r=this.getInstanceContainer(lr);if(x(t)&&(t=this.getService(t,e)),!t.prototype.$$metadata.nonShared){var o=r.filter((function(e){return e instanceof t}));o.length&&(n=o[0])}return n||(n=new t,r.push(n)),n}},{key:"parseFullName",value:function(t,e){var n={ns:"",key:""},r=t.split(".");return 1===r.length?n.key=t:(n.key=r.pop(),n.ns=r.join("."),e&&a(e,(function(t,e){if(t===n.ns)return n.ns=e,!0}))),n}},{key:"injectServices",value:function(t,e,n){var r,o=this,i=!1;if(n&&(r=U("{0}.{1}",e.namespace,e.key),i=-1!==this.serviceStack.indexOf(r),this.serviceStack.push(r),i))throw this.serviceStack.length=0,new Error("Loop dependency: "+this.serviceStack.join("->"));e&&w(e.inject)&&u(e.inject,(function(n,r){Object.defineProperty(t,r,{enumerable:!1,configurable:!1,get:function(){var i="$$"+r;if(null==t[i])if(x(n)){var u=o.parseFullName(n,e.alias);t[i]=o.createService(u.key,u.ns)}else t[i]=o.createService(n);return t[i]}})})),n&&this.serviceStack.pop()}}])&&dr(e.prototype,n),r&&dr(e,r),t}());function vr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mr(t,e,n){return e&&vr(t.prototype,e),n&&vr(t,n),t}function gr(t){this.$$velm=null,this.$$parent=null,this.$$children=[],this.$$renderer=null,this.$$observer=new Ze(this),this.$injector=br,this.$parser=new yr,this.$evaluator=new Te(this),this.slots={},this.events={},this.props=this.$delegate({}),this.state=this.$delegate({}),this.$data=l(this.$$metadata,t),br.injectServices(this,this.$data)}var wr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),gr.call(this,e)}return mr(t,[{key:"$delegate",value:function(t){return new Proxy(t,Q)}},{key:"$setSlot",value:function(t){this.slots=t||{}}},{key:"$setState",value:function(t){this.state=this.$delegate(t)}},{key:"$setProps",value:function(t){this.props=this.$delegate(t)}}]),mr(t,[{key:"$getFilter",value:function(t){var e=this.$injector.parseFullName(t,this.$data.alias);return this.$injector.createFilter(e.key,e.ns)}},{key:"$hasProperty",value:function(t){return void 0!==this.$getProperty(t)}},{key:"$getProperty",value:function(t){return L(this.props,t,!0)}},{key:"$setProperty",value:function(t,e){L(this.props,t,!0)!==e&&I(this.props,t,e,!0)}},{key:"$hasMessage",value:function(t){return D(this.events,t,!0)}},{key:"$bind",value:function(t,e){var n=L(this.events,t,!0);if(!Z(n))throw new Error(U('"{0}" is not a valid event',t));n.on(e)}},{key:"$unbind",value:function(t,e){var n=L(this.events,t,!0);Z(n)&&n.off(e)}},{key:"$watch",value:function(t,e,n){return this.$$observer.watch(t,e,n)}},{key:"$watchCollection",value:function(t,e,n){return this.$$observer.watchCollection(t,e,n)}},{key:"$eval",value:function(t,e){return this.$evaluator.evaluate(t,e)}},{key:"$assign",value:function(t,e,n){return this.$evaluator.assign(t,e,n)}},{key:"$getTemplate",value:function(){var t=this.$data;if(x(t.template))return t.template;if(x(t.templateId)){var e=document.getElementById(t.templateId);if(null!=e)return e.innerHTML}return""}},{key:"$render",value:function(){var t=this.$getTemplate();return this.$$renderer=new sr(this,t),this.$$renderer.render(),this.$$renderer}},{key:"$mount",value:function(t){var e;if(e=x(t)?document.querySelector(t):t,null==this.$$renderer)throw new Error("current component is not rendered");e.appendChild(this.$$renderer.view)}},{key:"$unmount",value:function(){}},{key:"$appendChild",value:function(t){this.$$children.push(t),t.$$parent=this}},{key:"$removeChild",value:function(t){var e=this.$$children.indexOf(t);-1!==e&&(this.$$children.splice(e,1),t.$$parent=null)}},{key:"$destroy",value:function(){this.$$observer.destroy(),null!=this.$$renderer&&this.$$renderer.destroy(),this.onDestroy&&this.onDestroy(),null!=this.$$parent&&this.$$parent.$removeChild(this)}}]),t}();function kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xr(t,e,n){return e&&kr(t.prototype,e),n&&kr(t,n),t}function Or(t){this.$$scope=null,this.$$vattr=null,this.$priority=9,this.$assignment=!1,this.$placeholder=null,this.$data=l(this.$$metadata,t),br.injectServices(this,this.$data)}var Er=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Or.call(this,e)}return xr(t,[{key:"$key",get:function(){return this.$$metadata.key}},{key:"$scope",get:function(){return this.$$scope}},{key:"$element",get:function(){return this.$$vattr.velm.elm}},{key:"$binding",get:function(){return this.$$vattr.nodeData.binding}},{key:"$component",get:function(){return this.$$vattr.velm.nodeData.component}}]),xr(t,[{key:"$compile",value:function(){return this.onCompile&&this.onCompile(this.$$vattr.velm,this.$$vattr)}},{key:"$link",value:function(){return this.onLink&&this.onLink(this.$scope)}},{key:"$postlink",value:function(){this.afterLink&&this.afterLink(),null!=this.$binding&&this.$change(this.$binding.value,this.$binding.oldValue)}},{key:"$change",value:function(t,e){this.onChange&&this.onChange(t,e)}},{key:"$destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"$$searchDirective",value:function(t,e){var n=t.nodeData.directives.filter((function(t){return t.$key===e}));return n.length?n[0]:null}},{key:"$seekDirective",value:function(t){var e=this.$$vattr.velm;return this.$$searchDirective(e,t)}},{key:"$seekUpDirective",value:function(t){var e=this.$$vattr.velm.parentNode;return this.$$searchDirective(e,t)}},{key:"$removeElement",value:function(t){if(null==this.$placeholder)throw new Error("you must define element placeholder!");t?null!=this.$element.parentNode&&nr(this.$element,this.$placeholder):null==this.$element.parentNode&&nr(this.$placeholder,this.$element)}},{key:"$hideElement",value:function(t){t?rr(this.$element,"m-hide"):or(this.$element,"m-hide")}},{key:"$render",value:function(t,e){var n=new sr(this.$scope,t,e);return n.render(),n}}]),t}();function Sr(t){this.$data=l(this.$$metadata,t),br.injectServices(this,this.$data)}var jr=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Sr.call(this,e)};function _r(t){this.$data=l(this.$$metadata,t),br.injectServices(this,this.$data,!0)}var Cr=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_r.call(this,e)};function Pr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $r=/^[a-z_\$][\w\$-]*/i,Nr=function(t){gr.call(this,t)};Nr.prototype=wr.prototype;var Tr=function(t){Or.call(this,t)};Tr.prototype=Er.prototype;var Ar=function(t){Sr.call(this,t)};Ar.prototype=jr.prototype;var Dr=function(t){_r.call(this,t)};Dr.prototype=Cr.prototype;var Lr,Ir=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"rename",value:function(t,e){if($r.test(e)){var n="";switch(e.split("-").forEach((function(t){n+=b(t[0])+t.substring(1)})),t){case fr:n+="Component";break;case hr:n+="Directive";break;case cr:n+="Filter";break;case lr:n+="Service"}return n}throw new Error(e+"is not a valid name")}},{key:"make",value:function(t,e,n,r){var o,i=this.rename(t,e);for(var u in o=new Function("onConstruct",'"use strict";return function '+i+"(){onConstruct.call(this);};")((function(){S(o.super)&&o.super.call(this),S(n.construct)&&n.construct.call(this,W)})),S(n.extends)&&y(o,n.extends),n)n.hasOwnProperty(u)&&"extends"!==u&&"construct"!==u&&(o.prototype[u]=n[u]);return r.key=e,o.prototype.$$metadata=r,o}},{key:"makeComponent",value:function(t,e,n){return e=l({extends:Nr},e),this.make(fr,t,e,n)}},{key:"makeDirective",value:function(t,e,n){return e=l({extends:Tr},e),this.make(hr,t,e,n)}},{key:"makeFilter",value:function(t,e,n){return e=l({extends:Ar},e),this.make(cr,t,e,n)}},{key:"makeService",value:function(t,e,n){return e=l({extends:Dr},e),this.make(lr,t,e,n)}}])&&Pr(e.prototype,n),r&&Pr(e,r),t}());function Vr(t){return{component:function(e,n,r){return r.namespace=t,function(t,e,n){var r=Ir.makeComponent(t,e,n);return br.registerComponent(t,r),r}(e,n,r)},directive:function(e,n,r){return r.namespace=t,function(t,e,n){var r=Ir.makeDirective(t,e,n);return br.registerDirective(t,r),r}(e,n,r)},service:function(e,n,r){return r.namespace=t,function(t,e,n){var r=Ir.makeService(t,e,n);return br.registerService(t,r),r}(e,n,r)},filter:function(e,n,r){return r.namespace=t,function(t,e,n){var r=Ir.makeFilter(t,e,n);return br.registerFilter(t,r),r}(e,n,r)}}}function Rr(t){return t instanceof wr}function Mr(t){return t instanceof Er}function Br(t){return t instanceof jr}function Fr(t){return t instanceof Cr}function Ur(t,e){var n,r=document.querySelector(t),o=new(Ir.makeComponent("root",e,{template:r.innerHTML}));er(n=r).forEach((function(t){n.removeChild(t)})),o.$render(),o.$mount(r)}function qr(t){return function(e){var n=t.key||e.name;e.prototype.$$metadata=t,br.registerComponent(n,e)}}function Kr(t){return function(e){var n=t.key||e.name;e.prototype.$$metadata=t,br.registerDirective(n,e)}}function zr(t){return function(e){var n=t.key||e.name;e.prototype.$$metadata=t,br.registerFilter(n,e)}}function Hr(t){return function(e){var n=t.key||e.name;e.prototype.$$metadata=t,br.registerService(n,e)}}function Wr(t){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zr(t,e){return!e||"object"!==Wr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gr(t){return(Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jr(t,e){return(Jr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qr;Kr({namespace:"automate",key:"m-bind"})(Lr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zr(this,Gr(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jr(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){this.$element.innerText=t}}])&&Yr(n.prototype,r),o&&Yr(n,o),e}(Er));function Xr(t){return(Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function to(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eo(t,e){return!e||"object"!==Xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ro(t,e){return(ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oo;Kr({namespace:"automate",key:"m-bind-html"})(Qr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),eo(this,no(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ro(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){this.$element.innerHTML=t}}])&&to(n.prototype,r),o&&to(n,o),e}(Er));function io(t){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ao(t,e){return!e||"object"!==io(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function so(t){return(so=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function co(t,e){return(co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lo;Kr({namespace:"automate",key:"m-repeat"})(oo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ao(this,so(e).call(this))).itemExp="",t.itemsExp="",t.itemTemplate="",t.buffer=new Map,t.unwatchCollection=null,t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&co(t,e)}(e,t),n=e,(r=[{key:"onCompile",value:function(t,e){var n=e.nodeValue,r=/^([a-z_]+\w+)\s+in\s+(.+)$/i.exec(n);if(null==r)throw new Error("m-repeat: parameter is not valid");return this.itemExp=r[1],this.itemsExp=r[2],t.removeAttr(e),this.itemTemplate=t.getOuterTpl(),!0}},{key:"onLink",value:function(t){var e=this,n=document.createDocumentFragment(),r=document.createComment("start: m-repeat"),o=document.createComment("end: m-repeat");return n.appendChild(r),n.appendChild(this.render(t)),n.appendChild(o),this.unwatchCollection=t.$watchCollection(this.itemsExp,(function(){var n,i,u,a=e.render(t);i=o,er(u=(n=r).parentNode).forEach((function(t){t.previousSibling===n&&t!==i&&u.removeChild(t),t.nextSibling===i&&t!==n&&u.removeChild(t)})),o.parentNode.insertBefore(a,o)})),n}},{key:"render",value:function(t){var e=this,n=t.$eval(this.itemsExp),r=document.createDocumentFragment(),o=new Map;return u(n,(function(t,n){var i=e.getRendererFromBuffer(e.buffer,t);if(!i){var u={};u.$key=n,u.$index=n,u[e.itemExp]=t,i=e.$render(e.itemTemplate,u)}e.setRendererToBuffer(o,t,i),r.appendChild(i.view)})),this.buffer.forEach((function(t){t.forEach((function(t){t.destroy()}))})),this.buffer=o,r}},{key:"getRendererFromBuffer",value:function(t,e){var n;if(t.has(e)){var r=t.get(e);r.length?n=r.shift():t.delete(e)}return n}},{key:"setRendererToBuffer",value:function(t,e,n){var r;t.has(e)?r=t.get(e):(r=[],t.set(e,r)),r.push(n)}},{key:"onDestroy",value:function(){this.buffer=null,this.unwatchCollection&&this.unwatchCollection()}}])&&uo(n.prototype,r),o&&uo(n,o),e}(Er));function fo(t){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function po(t,e){return!e||"object"!==fo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yo(t){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bo(t,e){return(bo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vo;Kr({namespace:"automate",key:"m-model"})(lo=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=po(this,yo(e).call(this))).viewValue=null,t.modelValue=null,t.parsers=[],t.formatters=[],t.viewChangeListeners=[],t.validators=[],t.status={feedback:"",pristine:!0,dirty:!1,valid:!0,invalid:!1},t.options={css:{pristine:"n-pristine",dirty:"n-dirty",valid:"n-valid",invalid:"n-invalid"}},t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bo(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){this.commitModelValue(t)}},{key:"afterLink",value:function(){var t=this,e=this.$element.name;e&&(this.$scope.state[e]=this.status),null!=this.$component?this.$component.$bind("change",(function(e){return t.commitViewValue(e.data.newvalue)})):this.$element.addEventListener("input",(function(e){return t.commitViewValue(e.target.value)}))}},{key:"onDestroy",value:function(){}},{key:"commitModelValue",value:function(t){if(this.modelValue!==t){var e=this;this.validators.forEach((function(n){n.call(e,t,this.modelValue)})),this.modelValue=t,this.formatters.forEach((function(n){t=n.call(e,t)})),this.viewValue!==t&&(this.viewValue=t,null!=this.$component?this.$component.$setProperty("value",t):this.$element.value=t,this.updateElmCssClass())}}},{key:"commitViewValue",value:function(t){if(this.viewValue!==t){var e=this;this.markDirtyStatus(!0),this.viewChangeListeners.forEach((function(n){n.call(e,t,e.viewValue)})),this.viewValue=t,this.parsers.forEach((function(n){t=n.call(e,t)})),this.modelValue!==t&&(this.validators.forEach((function(n){n.call(e,t,e.modelValue)})),this.modelValue=t,this.$binding.assign(t))}}},{key:"updateElmCssClass",value:function(){var t=this.$element,e=this.options.css;this.status.dirty?(t.classList.add(e.dirty),t.classList.remove(e.pristine)):(t.classList.add(e.pristine),t.classList.remove(e.dirty)),this.status.valid?(t.classList.add(e.valid),t.classList.remove(e.invalid)):(t.classList.add(e.invalid),t.classList.remove(e.valid))}},{key:"markDirtyStatus",value:function(t){this.status.dirty=t,this.status.pristine=!t,this.updateElmCssClass()}},{key:"markValidStatus",value:function(t,e){this.status.valid=t,this.status.invalid=!t,this.status.feedback=e,this.updateElmCssClass()}}])&&ho(n.prototype,r),o&&ho(n,o),e}(Er));function mo(t){return(mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wo(t,e){return!e||"object"!==mo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ko(t){return(ko=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xo(t,e){return(xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oo;Kr({namespace:"automate",key:"m-hide"})(vo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wo(this,ko(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xo(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){this.$hideElement(t)}}])&&go(n.prototype,r),o&&go(n,o),e}(Er));function Eo(t){return(Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function So(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jo(t,e){return!e||"object"!==Eo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _o(t){return(_o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Co(t,e){return(Co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Kr({namespace:"automate",key:"m-show"})(Oo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),jo(this,_o(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Co(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){this.$hideElement(!t)}}])&&So(n.prototype,r),o&&So(n,o),e}(Er));function Po(t){return(Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function No(t,e){return!e||"object"!==Po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function To(t){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ao(t,e){return(Ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Do,Lo=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=No(this,To(e).call(this))).key=t,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ao(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){t?this.$element.hasAttribute(this.key)||this.$element.setAttribute(this.key,""):this.$element.hasAttribute(this.key)&&this.$element.removeAttribute(this.key)}}])&&$o(n.prototype,r),o&&$o(n,o),e}(Er);function Io(t){return(Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vo(t,e){return!e||"object"!==Io(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ro(t){return(Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mo(t,e){return(Mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bo;Kr({namespace:"automate",key:"m-checked"})(Do=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Vo(this,Ro(e).call(this,"checked"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mo(t,e)}(e,t),e}(Lo));function Fo(t){return(Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uo(t,e){return!e||"object"!==Fo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qo(t){return(qo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ko(t,e){return(Ko=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zo;Kr({namespace:"automate",key:"m-disabled"})(Bo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Uo(this,qo(e).call(this,"disabled"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ko(t,e)}(e,t),e}(Lo));function Ho(t){return(Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,e){return!e||"object"!==Ho(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yo(t){return(Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zo(t,e){return(Zo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Go;Kr({namespace:"automate",key:"m-readonly"})(zo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Wo(this,Yo(e).call(this,"readonly"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zo(t,e)}(e,t),e}(Lo));function Jo(t){return(Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qo(t,e){return!e||"object"!==Jo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xo(t){return(Xo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei;Kr({namespace:"automate",selector:"m-selected"})(Go=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Qo(this,Xo(e).call(this,"selected"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,t),e}(Lo));function ni(t){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oi(t,e){return!e||"object"!==ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ii(t){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ui(t,e){return(ui=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ai,si=Kr({namespace:"automate",key:"m-class"})(ei=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),oi(this,ii(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ui(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t,e){this.skipCurrentElm()||(e&&or(this.$element,e.join(" ")),t&&rr(this.$element,t.join(" ")))}},{key:"skipCurrentElm",value:function(){return!1}}])&&ri(n.prototype,r),o&&ri(n,o),e}(Er))||ei;function ci(t){return(ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fi(t,e){return!e||"object"!==ci(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hi(t){return(hi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pi(t,e){return(pi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yi;Kr({namespace:"automate",key:"m-class-even"})(ai=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),fi(this,hi(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pi(t,e)}(e,t),n=e,(r=[{key:"skipCurrentElm",value:function(){return!0&this.$binding.evaluate("$index")}}])&&li(n.prototype,r),o&&li(n,o),e}(si));function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vi(t,e){return!e||"object"!==di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mi(t){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gi(t,e){return(gi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wi;Kr({namespace:"automate",key:"m-class-odd"})(yi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),vi(this,mi(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gi(t,e)}(e,t),n=e,(r=[{key:"skipCurrentElm",value:function(){return!1&this.$binding.evaluate("$index")}}])&&bi(n.prototype,r),o&&bi(n,o),e}(si));function ki(t){return(ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oi(t,e){return!e||"object"!==ki(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ei(t){return(Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Si(t,e){return(Si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ji,_i=Kr({namespace:"automate",key:"m-style"})(wi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Oi(this,Ei(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Si(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t,e){if(!this.skipCurrentElm()){var n=this;e&&u(e,(function(t,e){n.$element.style[e]=""})),w(t)&&u(t,(function(t,e){n.$element.style[e]=t}))}}},{key:"skipCurrentElm",value:function(){return!1}}])&&xi(n.prototype,r),o&&xi(n,o),e}(Er))||wi;function Ci(t){return(Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $i(t,e){return!e||"object"!==Ci(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ni(t){return(Ni=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ti(t,e){return(Ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ai;Kr({namespace:"automate",key:"m-style-even"})(ji=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),$i(this,Ni(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ti(t,e)}(e,t),n=e,(r=[{key:"skipCurrentElm",value:function(){return!0&this.$binding.evaluate("$index")}}])&&Pi(n.prototype,r),o&&Pi(n,o),e}(_i));function Di(t){return(Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ii(t,e){return!e||"object"!==Di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vi(t){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ri(t,e){return(Ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mi;Kr({namespace:"automate",key:"m-style-odd"})(Ai=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ii(this,Vi(e).call(this))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ri(t,e)}(e,t),n=e,(r=[{key:"skipCurrentElm",value:function(){return!1&this.$binding.evaluate("$index")}}])&&Li(n.prototype,r),o&&Li(n,o),e}(_i));function Bi(t){return(Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ui(t,e){return!e||"object"!==Bi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qi(t){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ki(t,e){return(Ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zi;Kr({namespace:"automate",key:"m-if"})(Mi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Ui(this,qi(e).call(this))).$placeholder=document.createComment("n-if"),t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ki(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){this.$removeElement(!t)}}])&&Fi(n.prototype,r),o&&Fi(n,o),e}(Er));function Hi(t){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yi(t,e){return!e||"object"!==Hi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zi(t){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gi(t,e){return(Gi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ji;Kr({namespace:"automate",key:"m-switch"})(zi=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Yi(this,Zi(e).call(this))).value=null,t.matchCount=0,t.changed=new W,t.defaultMatched=!0,t.matchDefault=new W,t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gi(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){this.value=t,this.changed.fire()}},{key:"plusMatch",value:function(){this.matchCount++,this.checkDefault()}},{key:"minusMatch",value:function(){this.matchCount--,this.checkDefault()}},{key:"checkDefault",value:function(){var t=this.matchCount<=0;this.defaultMatched!==t&&(this.defaultMatched=t,this.matchDefault.fire())}}])&&Wi(n.prototype,r),o&&Wi(n,o),e}(Er));function Qi(t){return(Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tu(t,e){return!e||"object"!==Qi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function eu(t){return(eu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nu(t,e){return(nu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ru;Kr({namespace:"automate",key:"m-switch-default"})(Ji=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=tu(this,eu(e).call(this))).switchCtrl=null,t.$placeholder=document.createComment("m-switch-default"),t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nu(t,e)}(e,t),n=e,(r=[{key:"afterLink",value:function(){var t=this;if(this.switchCtrl=this.$seekUpDirective("m-switch"),null==this.switchCtrl)throw new Error("Require m-switch directive");this.switchCtrl.matchDefault.on((function(){t.$removeElement(!t.switchCtrl.defaultMatched)})),this.switchCtrl.defaultMatched||this.$removeElement(!0)}}])&&Xi(n.prototype,r),o&&Xi(n,o),e}(Er));function ou(t){return(ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function uu(t,e){return!e||"object"!==ou(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function au(t){return(au=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function su(t,e){return(su=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cu;Kr({namespace:"automate",key:"m-switch-when"})(ru=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=uu(this,au(e).call(this))).value=null,t.matched=!1,t.switchCtrl=null,t.changed=new W,t.$placeholder=document.createComment("m-switch-when"),t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&su(t,e)}(e,t),n=e,(r=[{key:"afterLink",value:function(){var t=this;if(this.switchCtrl=this.$seekUpDirective("m-switch"),null==this.switchCtrl)throw new Error("Require m-switch directive");this.switchCtrl.changed.on((function(){t.render()}))}},{key:"onChange",value:function(t){this.value=t,this.render()}},{key:"render",value:function(){var t=this.switchCtrl.value===this.value;this.matched!=t&&(this.matched=t,t?this.switchCtrl.plusMatch():this.switchCtrl.minusMatch()),this.$removeElement(!t)}}])&&iu(n.prototype,r),o&&iu(n,o),e}(Er));function lu(t){return(lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hu(t,e){return!e||"object"!==lu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pu(t){return(pu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yu(t,e){return(yu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}qr({namespace:"automate",key:"slot"})(cu=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=hu(this,pu(e).call(this))).props.name="",t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yu(t,e)}(e,t),n=e,(r=[{key:"$render",value:function(){var t=this.$$parent.slots[this.props.name];if(t)return this.$$renderer=new sr(this.$$parent,t),this.$$renderer.render(),this.$$renderer}}])&&fu(n.prototype,r),o&&fu(n,o),e}(wr));n.d(e,"forEach",(function(){return u})),n.d(e,"some",(function(){return a})),n.d(e,"copy",(function(){return s})),n.d(e,"extend",(function(){return c})),n.d(e,"merge",(function(){return l})),n.d(e,"object",(function(){return p})),n.d(e,"inherit",(function(){return y})),n.d(e,"lowercase",(function(){return d})),n.d(e,"uppercase",(function(){return b})),n.d(e,"isUndefined",(function(){return v})),n.d(e,"isDefined",(function(){return m})),n.d(e,"isObject",(function(){return w})),n.d(e,"isBlankObject",(function(){return k})),n.d(e,"isNumber",(function(){return O})),n.d(e,"isDate",(function(){return E})),n.d(e,"isFunction",(function(){return S})),n.d(e,"isRegExp",(function(){return j})),n.d(e,"isBoolean",(function(){return _})),n.d(e,"isArray",(function(){return g})),n.d(e,"isString",(function(){return x})),n.d(e,"isSame",(function(){return P})),n.d(e,"isEmpty",(function(){return $})),n.d(e,"isFormData",(function(){return C})),n.d(e,"debug",(function(){return N})),n.d(e,"contains",(function(){return T})),n.d(e,"containsStr",(function(){return A})),n.d(e,"hasProperty",(function(){return D})),n.d(e,"getProperty",(function(){return L})),n.d(e,"setProperty",(function(){return I})),n.d(e,"concat",(function(){return V})),n.d(e,"orderBy",(function(){return R})),n.d(e,"orderByDescending",(function(){return M})),n.d(e,"toNumber",(function(){return B})),n.d(e,"remove",(function(){return F})),n.d(e,"format",(function(){return U})),n.d(e,"escapeHtml",(function(){return q})),n.d(e,"join",(function(){return K})),n.d(e,"Local",(function(){return z})),n.d(e,"Message",(function(){return W})),n.d(e,"events",(function(){return Y})),n.d(e,"isMessage",(function(){return Z})),n.d(e,"isProxy",(function(){return X})),n.d(e,"getTarget",(function(){return tt})),n.d(e,"handler",(function(){return Q})),n.d(e,"Observer",(function(){return Ze})),n.d(e,"parseOptions",(function(){return et})),n.d(e,"AST",(function(){return nt})),n.d(e,"NullExpressionNode",(function(){return rt})),n.d(e,"AstNode",(function(){return it})),n.d(e,"AssignmentExpressionNode",(function(){return lt})),n.d(e,"BinaryExpressionNode",(function(){return dt})),n.d(e,"CallExpressionNode",(function(){return wt})),n.d(e,"ConditionalExpressionNode",(function(){return St})),n.d(e,"ExpressionStatementNode",(function(){return $t})),n.d(e,"IdentifierNode",(function(){return Lt})),n.d(e,"LiteralNode",(function(){return Bt})),n.d(e,"LogicalExpressionNode",(function(){return zt})),n.d(e,"MemberExpressionNode",(function(){return Gt})),n.d(e,"ObjectExpressionNode",(function(){return ee})),n.d(e,"ProgramNode",(function(){return ue})),n.d(e,"PropertyNode",(function(){return fe})),n.d(e,"UnaryExpressionNode",(function(){return be})),n.d(e,"ArrayExpressionNode",(function(){return ke})),n.d(e,"ExpLexer",(function(){return Ee})),n.d(e,"ExpParser",(function(){return je})),n.d(e,"lexExp",(function(){return _e})),n.d(e,"parseExp",(function(){return Ce})),n.d(e,"ExpBuilder",(function(){return $e})),n.d(e,"Evaluator",(function(){return Te})),n.d(e,"Analyser",(function(){return Ve})),n.d(e,"nodeType",(function(){return Je})),n.d(e,"VNode",(function(){return Qe})),n.d(e,"VAttr",(function(){return on})),n.d(e,"VCmnt",(function(){return fn})),n.d(e,"VElm",(function(){return Vn})),n.d(e,"VText",(function(){return qn})),n.d(e,"VType",(function(){return Yn})),n.d(e,"lexTpl",(function(){return En})),n.d(e,"parseTpl",(function(){return Sn})),n.d(e,"isVElm",(function(){return jn})),n.d(e,"isVAttr",(function(){return _n})),n.d(e,"isVText",(function(){return Cn})),n.d(e,"isVComment",(function(){return Pn})),n.d(e,"TplBuilder",(function(){return Nn})),n.d(e,"Binding",(function(){return tr})),n.d(e,"Expression",(function(){return Gn})),n.d(e,"Renderer",(function(){return sr})),n.d(e,"Component",(function(){return wr})),n.d(e,"Directive",(function(){return Er})),n.d(e,"Filter",(function(){return jr})),n.d(e,"Service",(function(){return Cr})),n.d(e,"isComponent",(function(){return Rr})),n.d(e,"isDirective",(function(){return Mr})),n.d(e,"isFilter",(function(){return Br})),n.d(e,"isService",(function(){return Fr})),n.d(e,"namespace",(function(){return Vr})),n.d(e,"render",(function(){return Ur})),n.d(e,"injector",(function(){return br})),n.d(e,"component",(function(){return qr})),n.d(e,"directive",(function(){return Kr})),n.d(e,"filter",(function(){return zr})),n.d(e,"service",(function(){return Hr})),n.d(e,"ClassDirective",(function(){return si})),n.d(e,"StyleDirective",(function(){return _i}))}])}));