!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.automate=e():t.automate=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.r(e);var i=Object.prototype.toString,o=Object.getPrototypeOf;function a(t,e,n){if(g(t)){for(var r=0;r<t.length;r++)if(e(t[r],r))return}else if(k(t)){for(var i in t)if((n||t.hasOwnProperty(i))&&e(t[i],i))return}else e(t,t)}function u(t,e){if(g(t)){for(var n=0;n<t.length;n++)if(e(n,t[n]))return!0}else{if(!k(t))return e(t,t);for(var r in t)if(t.hasOwnProperty(r)&&e(r,t[r]))return!0}}function s(){var t,e=!1,n=0,r=arguments[n];if(j(r)&&(e=r,n++,r=arguments[n]),arguments.length>n+1&&(t=arguments[n+1]),g(r)){var i=[];return r.forEach((function(n,o){(null==t||t(r,o,n))&&i.push(e?s(n):n)})),i}if(k(r)){var o=p(r);return a(r,(function(n,i){(null==t||t(r,i,n))&&(o[i]=e?s(n):n)})),o}return r}function c(){var t=!1,e=0,n=arguments[e];j(n)&&(t=n,n=arguments[++e]),t?Array.prototype.slice.call(arguments,e+1).forEach((function(t){h(n,t)})):Array.prototype.slice.call(arguments,e+1).forEach((function(t){f(n,t)}))}function l(){var t=!1,e=0,n={};return j(arguments[e])&&(t=arguments[e],e++),t?Array.prototype.slice.call(arguments,e).forEach((function(t){h(n,t)})):Array.prototype.slice.call(arguments,e).forEach((function(t){f(n,t)})),n}function f(t,e){a(e,(function(e,n){t[n]=e}))}function h(t,e){a(e,(function(e,n){null==t[n]?t[n]=e:k(t[n])&&k(e)?h(t[n],e):t[n]=e}))}function p(t){function e(){}return e.prototype=t,new e}function y(t,e){!function(t,e){var n=p(e.prototype);n.constructor=t,t.prototype=n}(t,e),t.super=function(){e.apply(this,arguments)}}function d(t){return w(t)?t.toLowerCase():t}function v(t){return w(t)?t.toUpperCase():t}function b(t){return void 0===t}function m(t){return void 0!==t}function g(t){return t instanceof Array}function k(t){return null!==t&&"object"===r(t)}function x(t){return null!==t&&"object"===r(t)&&!o(t)}function w(t){return"string"==typeof t}function E(t){return"number"==typeof t}function O(t){return"[object Date]"===i.call(t)}function S(t){return"function"==typeof t}function C(t){return"[object RegExp]"===i.call(t)}function j(t){return"boolean"==typeof t}function $(t){return"undefined"!=typeof FormData&&t instanceof FormData}function N(t,e){var n=t===e;return n||(g(t)&&g(e)?t.length===e.length&&(n=!u(t,(function(t,n){return!N(n,e[t])}))):k(t)&&k(e)&&o(t)===o(e)&&(n=!u(t,(function(t,n){return!N(n,e[t])})))),n}function _(t){console.log(t)}function P(t,e){return t.some((function(t){return t===e}))}function T(t,e,n){return t.some((function(t){return t===e||n&&d(t)===d(e)}))}function A(t,e,n){if(!t)return!1;for(var r,i=!0,o=e.split("."),u=t;i&&o.length>0;)r=o.shift(),i=!1,a(u,(function(t,e){return(i=e===r||n&&d(e)===d(r))&&(u=t),i}),!0);return i}function I(t,e,n){if(!t)return null;for(var r,i=!0,o=e.split("."),u=t;i&&o.length>0;)r=o.shift(),i=!1,a(u,(function(t,e){return(i=e===r||n&&d(e)===d(r))&&(u=t),i}),!0);return i?u:null}function D(t,e,n,r){if(t){for(var i,o=!0,u=e.split("."),s=t;o&&u.length>0;)i=u.shift(),0===u.length?s[i]=n:(o=!1,a(s,(function(t,e){return(o=e===i||r&&d(e)===d(i))&&(s=t),o}),!0));if(!o)throw new Error(e+": Can not set property of undefined")}}function L(){return Array.prototype.concat.apply([],arguments)}function V(t,e){var n=function(t){return null==e?t:e(t)};return t.sort((function(t,e){return n(t)<n(e)?-1:n(t)>n(e)?1:0}))}function M(t,e){var n=function(t){return null==e?t:e(t)};return t.sort((function(t,e){return n(t)<n(e)?1:n(t)>n(e)?-1:0}))}function R(t){var e=parseFloat(t);return isNaN(e)?t:e}function B(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}function U(){if(0!==arguments.length){for(var t,e,n="",r=arguments[0],i=/\{(\d+)\}/g,o=i.lastIndex;t=i.exec(r);){if(t[0],e=Number.parseInt(t[1])+1,arguments.length<=e)throw new Error("format item "+e+"is not defined");n+=r.substring(o,t.index)+arguments[e],o=i.lastIndex}return n+=r.substring(o)}}function F(t){return t.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&quote;/g,"")}function W(t,e){var n="",r=e.length;return e.forEach((function(e,i){n+=e,i+1<r&&(n+=t)})),n}var q=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$event=e,this.$element=n,this.$argument=r};function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var H=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handlers=[]}var e,n,r;return e=t,(n=[{key:"on",value:function(t){this.handlers.push(t)}},{key:"off",value:function(t){for(var e=0;e<this.handlers.length;e++)this.handlers[e]===t&&this.handlers.splice(e,1)}},{key:"fire",value:function(t,e){var n;e=e||this;for(var r=0;r<this.handlers.length;r++)S(this.handlers[r])&&(n=this.handlers[r].call(e,t));return n}}])&&K(e.prototype,n),r&&K(e,r),t}();function z(t){return t instanceof H}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Z=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.messages={}}var e,n,r;return e=t,(n=[{key:"get",value:function(t){return this.messages[t]||(this.messages[t]=new H),this.messages[t]}},{key:"on",value:function(t,e){this.get(t).on(e)}},{key:"off",value:function(t,e){this.get(t).off(e)}},{key:"fire",value:function(t,e,n){return this.get(t).fire(e,n)}}])&&Y(e.prototype,n),r&&Y(e,r),t}(),G={propChanging:new H,propChanged:new H};function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tt(t,e){return(tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rt(t,e,n){return e&&nt(t.prototype,e),n&&nt(t,n),t}var it=function(){function t(){et(this,t)}return rt(t,[{key:"set",value:function(t,e,n){var r=t[e];if(r!==n||g(t)&&"length"===e){var i={valid:!0,apply:!0,oldValue:r,newValue:n};G.propChanging.fire({target:t,key:e,data:i}),i.apply&&(t[e]=n,G.propChanged.fire({target:t,key:e,data:{oldValue:r,newValue:n}}))}return!0}}]),t}(),ot=function(){function t(e,n){et(this,t),this.target=e,this.handler=n}return rt(t,[{key:"get",value:function(t){return this.target[t]}},{key:"set",value:function(t,e){this.handler.set(this.target,t,e)}}]),t}(),at=function(t){function e(t,n){return et(this,e),Q(this,X(e).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(e,t),rt(e,[{key:"length",get:function(){return this.target.length},set:function(t){this.handler.set(this.target,"length",t)}}]),rt(e,[{key:"concat",value:function(){var t=Array.prototype.slice.call(arguments,0);return Array.prototype.concat.apply(this.target,t)}},{key:"join",value:function(){var t=Array.prototype.slice.call(arguments,0);return Array.prototype.join.apply(this.target,t)}},{key:"pop",value:function(){var t,e=this.target.length;if(0!==e)return--e>=0&&(t=this.target[e]),this.handler.set(this.target,"length",e),t}},{key:"push",value:function(){var t=this,e=this.target.length;return arguments.length>0&&(Array.prototype.slice.call(arguments,0).forEach((function(n,r){t.handler.set(t.target,e+r,n)})),e+=arguments.length,this.handler.set(this.target,"length",e)),e}},{key:"reverse",value:function(){var t=this;if(0!==this.target.length){var e=s(this.target);e.reverse(),e.forEach((function(e,n){e!==t.target[n]&&t.handler.set(t.target,n,e)}))}}},{key:"shift",value:function(){var t=this.target.length;if(t>0){for(var e=this.target[t-1];1<t;)this.handler.set(this.target,0,this.target[1]);return this.handler.set(this.target,"length",t-1),e}}},{key:"slice",value:function(){var t=Array.prototype.slice.call(arguments,0);return Array.prototype.slice.apply(this.target,t)}},{key:"sort",value:function(){var t=Array.prototype.slice.call(arguments,0);return Array.prototype.sort.apply(this.target,t)}},{key:"splice",value:function(){var t=this,e=this.target.length,n=s(this.target),r=Array.prototype.slice.call(arguments,0),i=Array.prototype.slice.apply(n,r);return n.forEach((function(e,n){e!==t.target[n]&&t.handler.set(t.target,n,t.target[n])})),n.length!==e&&this.handler.set(this.target,"length",n.length),i}}]),e}(ot),ut=new it;function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.prototype.delegate=function(t){var e;return e=m(Proxy)?new Proxy(this,ut):g(this)?new at(this):k(this)?new ot(this):this,t&&t.call(this,e),e};var ct=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=e,this.keys={}}var e,n,r;return e=t,(n=[{key:"getHandlers",value:function(t){return this.keys[t]||(this.keys[t]=[]),this.keys[t]}},{key:"registerKey",value:function(t,e){this.getHandlers(t).push(e)}},{key:"unregisterKey",value:function(t,e){var n=this.getHandlers(t);if(null==e)n.length=0;else{var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},{key:"fireKey",value:function(t,e,n){this.getHandlers(t).forEach((function(t){t.call(n,e)}))}}])&&st(e.prototype,n),r&&st(e,r),t}(),lt={isIdentifierContinue:!1,isIdentifierStart:!1,literals:{false:!1,null:null,true:!0,undefined:void 0}};var ft={Program:"Program",ExpressionStatement:"ExpressionStatement",AssignmentExpression:"AssignmentExpression",ConditionalExpression:"ConditionalExpression",LogicalExpression:"LogicalExpression",BinaryExpression:"BinaryExpression",UnaryExpression:"UnaryExpression",CallExpression:"CallExpression",MemberExpression:"MemberExpression",Identifier:"Identifier",Literal:"Literal",ArrayExpression:"ArrayExpression",Property:"Property",ObjectExpression:"ObjectExpression"},ht=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$null=!0};function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var yt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.childNodes=[]}var e,n,r;return e=t,(n=[{key:"appendChild",value:function(t){this.childNodes.push(t)}}])&&pt(e.prototype,n),r&&pt(e,r),t}();function dt(t){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){return!e||"object"!==dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bt(t){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gt=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=vt(this,bt(e).call(this,ft.AssignmentExpression))).left=t,i.right=n,i.operator=r,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(e,t),e}(yt);function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xt(t,e){return!e||"object"!==kt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ot=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=xt(this,wt(e).call(this,ft.BinaryExpression))).operator=t,i.left=n,i.right=r,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(e,t),e}(yt);function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ct(t,e){return!e||"object"!==St(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jt(t){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $t(t,e){return($t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nt=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ct(this,jt(e).call(this,ft.CallExpression))).callee=t,r.args=n,r.filter=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$t(t,e)}(e,t),e}(yt);function _t(t){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){return!e||"object"!==_t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function At(t,e){return(At=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var It=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Pt(this,Tt(e).call(this,ft.ConditionalExpression))).test=t,i.alternate=n,i.consequent=r,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&At(t,e)}(e,t),e}(yt);function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lt(t,e){return!e||"object"!==Dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vt(t){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Lt(this,Vt(e).call(this,ft.ExpressionStatement))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(e,t),e}(yt);function Bt(t){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,e){return!e||"object"!==Bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ft(t){return(Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wt(t,e){return(Wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ut(this,Ft(e).call(this,ft.Identifier))).name=t,n.allowNull=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wt(t,e)}(e,t),e}(yt);function Kt(t){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ht(t,e){return!e||"object"!==Kt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yt(t,e){return(Yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ht(this,zt(e).call(this,ft.Literal))).value=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yt(t,e)}(e,t),e}(yt);function Gt(t){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jt(t,e){return!e||"object"!==Gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qt(t){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xt(t,e){return(Xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var te=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Jt(this,Qt(e).call(this,ft.LogicalExpression))).operator=t,i.left=n,i.right=r,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xt(t,e)}(e,t),e}(yt);function ee(t){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ne(t,e){return!e||"object"!==ee(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function re(t){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ie(t,e){return(ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oe=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=ne(this,re(e).call(this,ft.MemberExpression))).object=t,i.property=n,i.computed=r,i.allowNull=!1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ie(t,e)}(e,t),e}(yt);function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ue(t,e){return!e||"object"!==ae(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function se(t){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ce(t,e){return(ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var le=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ue(this,se(e).call(this,ft.ObjectExpression))).properties=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ce(t,e)}(e,t),e}(yt);function fe(t){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function he(t,e){return!e||"object"!==fe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pe(t){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ye(t,e){return(ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var de=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),he(this,pe(e).call(this,ft.Program))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ye(t,e)}(e,t),e}(yt);function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function be(t,e){return!e||"object"!==ve(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function me(t){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ge(t,e){return(ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ke=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=be(this,me(e).call(this,ft.Property))).kind="init",t.key=null,t.value=null,t.computed=!1,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ge(t,e)}(e,t),e}(yt);function xe(t){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function we(t,e){return!e||"object"!==xe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oe(t,e){return(Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Se=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=we(this,Ee(e).call(this,ft.UnaryExpression))).prefix=!0,r.operator=t,r.arg=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oe(t,e)}(e,t),e}(yt);function Ce(t){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function je(t,e){return!e||"object"!==Ce(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $e(t){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ne(t,e){return(Ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _e=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),je(this,$e(e).call(this,ft.ArrayExpression))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ne(t,e)}(e,t),e}(yt),Pe={};function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}"+ - * / % === !== == != < > <= >= && || ! = |".split(" ").forEach((function(t){Pe[t]=!0}));var Ae=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=l(lt,e)}var e,n,r;return e=t,(n=[{key:"lex",value:function(t){for(this.text=t,this.index=0,this.tokens=[];this.index<this.text.length;){var e=this.text.charAt(this.index);if('"'===e||"'"===e)this.readString(e);else if(this.isNumber(e)||"."===e&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(e,"(){}[].,;:?"))this.tokens.push({index:this.index,text:e}),this.index++;else if(this.isWhitespace(e))this.index++;else{var n=e+this.peek(),r=n+this.peek(2),i=Pe[e],o=Pe[n],a=Pe[r];if(i||o||a){var u=a?r:o?n:e;this.tokens.push({index:this.index,text:u,operator:!0}),this.index+=u.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens}},{key:"is",value:function(t,e){return-1!==e.indexOf(t)}},{key:"peek",value:function(t){var e=t||1;return this.index+e<this.text.length&&this.text.charAt(this.index+e)}},{key:"isNumber",value:function(t){return"0"<=t&&t<="9"&&"string"==typeof t}},{key:"isWhitespace",value:function(t){return" "===t||"\r"===t||"\t"===t||"\n"===t||"\v"===t||" "===t}},{key:"isIdentifierStart",value:function(t){return this.options.isIdentifierStart?this.options.isIdentifierStart(t,this.codePointAt(t)):this.isValidIdentifierStart(t)}},{key:"isValidIdentifierStart",value:function(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"||"_"===t||"$"===t}},{key:"isIdentifierContinue",value:function(t){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(t,this.codePointAt(t)):this.isValidIdentifierContinue(t)}},{key:"isValidIdentifierContinue",value:function(t,e){return this.isValidIdentifierStart(t,e)||this.isNumber(t)}},{key:"codePointAt",value:function(t){return 1===t.length?t.charCodeAt(0):(t.charCodeAt(0)<<10)+t.charCodeAt(1)-56613888}},{key:"peekMultichar",value:function(){var t=this.text.charAt(this.index),e=this.peek();if(!e)return t;var n=t.charCodeAt(0),r=e.charCodeAt(0);return n>=55296&&n<=56319&&r>=56320&&r<=57343?t+e:t}},{key:"isExpOperator",value:function(t){return"-"===t||"+"===t||this.isNumber(t)}},{key:"throwError",value:function(t,e,n){n=n||this.index;var r=m(e)?"s "+e+"-"+this.index+" ["+this.text.substring(e,n)+"]":" "+n;throw new Error("Lexer Error: "+t+" at column"+r+" in expression ["+this.text+"].")}},{key:"readNumber",value:function(){for(var t="",e=this.index;this.index<this.text.length;){var n=d(this.text.charAt(this.index));if("."===n||this.isNumber(n))t+=n;else{var r=this.peek();if("e"===n&&this.isExpOperator(r))t+=n;else if(this.isExpOperator(n)&&r&&this.isNumber(r)&&"e"===t.charAt(t.length-1))t+=n;else{if(!this.isExpOperator(n)||r&&this.isNumber(r)||"e"!==t.charAt(t.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:e,text:t,constant:!0,value:Number(t)})}},{key:"readIdent",value:function(){var t=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var e=this.peekMultichar();if(!this.isIdentifierContinue(e))break;this.index+=e.length}this.tokens.push({index:t,text:this.text.slice(t,this.index),identifier:!0})}},{key:"readString",value:function(t){var e=this.index;this.index++;for(var n="",r=t,i=!1;this.index<this.text.length;){var o=this.text.charAt(this.index);if(r+=o,i){if("u"===o){var a=this.text.substring(this.index+1,this.index+5);a.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+a+"]"),this.index+=4,n+=String.fromCharCode(parseInt(a,16))}else n+=ESCAPE[o]||o;i=!1}else if("\\"===o)i=!0;else{if(o===t)return this.index++,void this.tokens.push({index:e,text:r,constant:!0,value:n});n+=o}this.index++}this.throwError("Unterminated quote",e)}}])&&Te(e.prototype,n),r&&Te(e,r),t}();function Ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var De=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lexer=e,this.options=l(lt,n)}var e,n,r;return e=t,(n=[{key:"throwError",value:function(t,e){throw new Error("Syntax Error: Token '"+e.text+"'"+t+" at column "+(e.index+1)+" of the expression ["+this.text+"] starting at ["+this.text.substring(e.index)+"].")}},{key:"parse",value:function(t){this.text=t,this.tokens=this.lexer.lex(t);var e=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),e}},{key:"program",value:function(){for(var t=new de;;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&t.appendChild(this.expressionStatement()),!this.expect(";"))return t}},{key:"expressionStatement",value:function(){var t=new Rt;return t.appendChild(this.filterChain()),t}},{key:"filterChain",value:function(){for(var t=this.expression();this.expect("|");)t=this.filter(t);return t}},{key:"expression",value:function(){return this.assignment()}},{key:"isAssignable",value:function(t){return t.type===ft.Identifier||t.type===ft.MemberExpression}},{key:"assignment",value:function(){var t=this.ternary();if(this.expect("=")){if(!this.isAssignable(t))throw new Error("Trying to assign a value to a non l-value");t=new gt(t,this.assignment(),"=")}return t}},{key:"ternary",value:function(){var t,e,n=this.logicalOR();return this.expect("?")&&(t=this.expression(),this.consume(":"))?(e=this.expression(),new It(n,t,e)):n}},{key:"logicalOR",value:function(){for(var t=this.logicalAND();this.expect("||");)t=new te("||",t,this.logicalAND());return t}},{key:"logicalAND",value:function(){for(var t=this.equality();this.expect("&&");)t=new te("&&",t,this.equality());return t}},{key:"equality",value:function(){for(var t,e=this.relational();t=this.expect("==","!=","===","!==");)e=new Ot(t.text,e,this.relational());return e}},{key:"relational",value:function(){for(var t,e=this.additive();t=this.expect("<",">","<=",">=");)e=new Ot(t.text,e,this.additive());return e}},{key:"additive",value:function(){for(var t,e=this.multiplicative();t=this.expect("+","-");)e=new Ot(t.text,e,this.multiplicative());return e}},{key:"multiplicative",value:function(){for(var t,e=this.unary();t=this.expect("*","/","%");)e=new Ot(t.text,e,this.unary());return e}},{key:"unary",value:function(){var t;return(t=this.expect("+","-","!"))?new Se(t.text,this.unary()):this.primary()}},{key:"primary",value:function(){var t,e;for(this.expect("(")?(t=this.filterChain(),this.consume(")")):this.expect("[")?t=this.arrayDeclaration():this.expect("{")?t=this.object():this.options.literals.hasOwnProperty(this.peek().text)?t=new Zt(this.options.literals[this.consume().text]):this.peek().identifier?t=this.identifier():this.peek().constant?t=this.constant():this.throwError("not a primary expression",this.peek());this.peek("(","[",".")||this.peek("?")&&this.peekAhead(1,".");)this.expect("?")&&(t.allowNull=!0),"("===(e=this.expect("(","[",".")).text?(t=new Nt(t,this.parseArguments()),this.consume(")")):"["===e.text?(t=new oe(t,this.expression(),!0),this.consume("]")):"."===e.text?t=new oe(t,this.identifier(),!1):this.throwError("IMPOSSIBLE");return t}},{key:"filter",value:function(t){for(var e=[t],n=[this.identifier()];this.expect(".");)n.push(this.identifier());var r=n.map((function(t){return t.name})).join("."),i=new Nt(new qt(r),e);for(i.filter=!0;this.expect(":");)e.push(this.expression());return i}},{key:"parseArguments",value:function(){var t=[];if(")"!==this.peekToken().text)do{t.push(this.filterChain())}while(this.expect(","));return t}},{key:"identifier",value:function(){var t=this.consume();return t.identifier||this.throwError("is not a valid identifier",t),new qt(t.text)}},{key:"constant",value:function(){return new Zt(this.consume().value)}},{key:"arrayDeclaration",value:function(){var t=new _e;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;t.appendChild(this.expression())}while(this.expect(","));return this.consume("]"),t}},{key:"object",value:function(){var t,e=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;t=new ke,this.peek().constant?(t.key=this.constant(),t.computed=!1,this.consume(":"),t.value=this.expression()):this.peek().identifier?(t.key=this.identifier(),t.computed=!1,this.peek(":")?(this.consume(":"),t.value=this.expression()):t.value=t.key):this.peek("[")?(this.consume("["),t.key=this.expression(),this.consume("]"),t.computed=!0,this.consume(":"),t.value=this.expression()):this.throwError("invalid key",this.peek()),e.push(t)}while(this.expect(","));return this.consume("}"),new le(e)}},{key:"consume",value:function(t){if(0===this.tokens.length)throw new Error("Unexpected end of expression: "+this.text);var e=this.expect(t);return e||this.throwError("is unexpected, expecting ["+t+"]",this.peek()),e}},{key:"peekToken",value:function(){if(0===this.tokens.length)throw new Error("Unexpected end of expression: "+this.text);return this.tokens[0]}},{key:"peek",value:function(t,e,n,r){return this.peekAhead(0,t,e,n,r)}},{key:"peekAhead",value:function(t,e,n,r,i){if(this.tokens.length>t){var o=this.tokens[t],a=o.text;if(a===e||a===n||a===r||a===i||!e&&!n&&!r&&!i)return o}return!1}},{key:"expect",value:function(t,e,n,r){var i=this.peek(t,e,n,r);return!!i&&(this.tokens.shift(),i)}}])&&Ie(e.prototype,n),r&&Ie(e,r),t}();function Le(t){return(new Ae).lex(t)}function Ve(t){return new De(new Ae).parse(t)}function Me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Re=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"build",value:function(t){var e;switch(t.type){case ft.ExpressionStatement:e=this.buildExpression(t);break;case ft.AssignmentExpression:e=this.buildAssignment(t);break;case ft.ConditionalExpression:e=this.buildCondition(t);break;case ft.LogicalExpression:e=this.buildLogic(t);break;case ft.BinaryExpression:e=this.buildBinary(t);break;case ft.UnaryExpression:e=this.buildUnary(t);break;case ft.CallExpression:e=this.buildCall(t);break;case ft.MemberExpression:e=this.buildMember(t);break;case ft.Identifier:e=this.buildIdentifier(t);break;case ft.Literal:e=this.buildLiteral(t);break;case ft.ArrayExpression:e=this.buildArray(t);break;case ft.Property:e=this.buildProperty(t);break;case ft.ObjectExpression:e=this.buildObject(t)}return e}},{key:"buildExpression",value:function(t){var e,n=this;return t.childNodes.forEach((function(t){e=n.build(t)})),e}},{key:"buildAssignment",value:function(t){return U("{0}={1}",this.build(t.left),this.build(t.right))}},{key:"buildCondition",value:function(t){return U("{0}?{1}:{2}",this.build(t.test),this.build(t.alternate),this.build(t.consequent))}},{key:"buildLogic",value:function(t){var e=this.build(t.left),n=this.build(t.right);return U("{0}{1}{2}",e,t.operator,n)}},{key:"buildBinary",value:function(t){var e=this.build(t.left),n=this.build(t.right);return U("{0}{1}{2}",e,t.operator,n)}},{key:"buildUnary",value:function(t){var e=this.build(t.arg);return U("{0}{1}",t.operator,e)}},{key:"buildCall",value:function(t){var e=this,n="",r=t.args.map((function(t){return e.build(t)})),i=this.build(t.callee);return t.filter?(r.length>0&&(n=r.shift()),n+=" | "+i,r.length>0&&(n+=":"+W(":",r))):n=U("{0}({1})",i,W(", ",r)),n}},{key:"buildMember",value:function(t){var e=this.build(t.object),n=this.build(t.property);return t.computed?U("{0}[{1}]",e,n):U("{0}.{1}",e,n)}},{key:"buildIdentifier",value:function(t){return t.name}},{key:"buildLiteral",value:function(t){return w(t.value)?U('"{0}"',t.value):t.value}},{key:"buildProperty",value:function(t){return U("{0}:{1}",this.build(t.key,{propertyKey:!0}),this.build(t.value))}},{key:"buildObject",value:function(t){var e=this;return U("{{0}}",W(", ",t.properties.map((function(t){return e.build(t)}))))}},{key:"buildArray",value:function(t){var e=this;return U("[{0}]",W(",",t.childNodes.map((function(t){return e.build(t)}))))}}])&&Me(e.prototype,n),r&&Me(e,r),t}();function Be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ue=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scope=e,this.locals=n||{},this.program=null,this.options=l({allowNull:!1,assignInterceptor:null},r),this.builder=new Re}var e,n,r;return e=t,(n=[{key:"evaluate",value:function(t){var e,n=this;return this.program=Ve(t),this.program.childNodes.forEach((function(t){e=n.evaluateNode(t)})),e&&e.$null&&(e=null),e}},{key:"assign",value:function(t,e){if(this.program=Ve(t),1!==this.program.childNodes.length)throw new Error(U("{0} is not a valid assignment",t));var n=this.program.childNodes[0];if(n.childNodes.length>1)throw new Error(U("{0} is not a valid assignment",t));var r=n.childNodes[0];if(r.type===ft.MemberExpression){var i=this.evaluateNode(r.object);if(null==i)throw new Error(U("{0} is null or undefined",this.builder.build(r.object)));if(null==(o=this.evaluateNode(r.property,{propertyKey:!r.computed})))throw new Error(U("{0} is null or undefined",this.builder.build(r.property)));null==this.assignInterceptor?i[o]=e:this.options.assignInterceptor.call(this,i,o)}else{if(r.type!==ft.Identifier)throw new Error(U("{0} is not a valid assignment",t));var o=this.evaluateNode(r);null==this.assignInterceptor?this.scope[o]=e:this.options.assignInterceptor.call(this,this.scope,o)}}},{key:"evaluateNode",value:function(t,e){var n;switch(t.type){case ft.ExpressionStatement:n=this.evaluateExpression(t);break;case ft.AssignmentExpression:n=this.evaluateAssignment(t);break;case ft.ConditionalExpression:n=this.evaluateCondition(t);break;case ft.LogicalExpression:n=this.evaluateLogic(t);break;case ft.BinaryExpression:n=this.evaluateBinary(t);break;case ft.UnaryExpression:n=this.evaluateUnary(t);break;case ft.CallExpression:n=this.evaluateCall(t);break;case ft.MemberExpression:n=this.evaluateMember(t,e);break;case ft.Identifier:n=this.evaluateIdentifier(t,e);break;case ft.Literal:n=this.evaluateLiteral(t);break;case ft.ArrayExpression:n=this.evaluateArray(t);break;case ft.Property:n=this.evaluateProperty(t);break;case ft.ObjectExpression:n=this.evaluateObject(t)}return n}},{key:"evaluateExpression",value:function(t){var e,n=this;return t.childNodes.forEach((function(t){e=n.evaluateNode(t)})),e}},{key:"evaluateAssignment",value:function(t){var e=this.evaluateNode(t.left,{assignmentLeft:!0}),n=this.evaluateNode(t.right);null==this.options.assignInterceptor?e.obj[e.prop]=n:this.options.assignInterceptor.call(this,e.obj,e.prop)}},{key:"evaluateCondition",value:function(t){return this.evaluateNode(t.test)?this.evaluateNode(t.alternate):this.evaluateNode(t.consequent)}},{key:"evaluateLogic",value:function(t){var e,n=this.evaluateNode(t.left),r=this.evaluateNode(t.right);switch(t.operator){case"&&":case"||":e=n&&r}return e}},{key:"evaluateBinary",value:function(t){var e,n=this.evaluateNode(t.left),r=this.evaluateNode(t.right);switch(t.operator){case"+":e=n+r;break;case"-":e=n-r;break;case"*":e=n*r;break;case"/":e=n/r;break;case"%":e=n%r;break;case"<":e=n<r;break;case">":e=n>r;break;case"<=":e=n<=r;break;case">=":e=n>=r;break;case"==":e=n==r;break;case"!=":e=n!=r;break;case"===":e=n===r;break;case"!==":e=n!==r}return e}},{key:"evaluateUnary",value:function(t){var e,n=this.evaluateNode(t.arg);switch(t.operator){case"+":e=n;break;case"-":e=-n;break;case"!":e=!n}return e}},{key:"evaluateCall",value:function(t){var e=this,n=t.args.map((function(t){return e.evaluateNode(t)})),r=this.evaluateNode(t.callee,{callee:!0});if(t.filter){if(this.scope.$hasFilter(r.prop)){var i=this.scope.$getFilter(r.prop);return i.execute.apply(i,n)}throw new Error('Filter "'+r.prop+'" is not defined')}var o=r.obj[r.prop];if(S(o))return o.apply(r.obj,n);throw new Error(r.prop+" is not a function")}},{key:"evaluateMember",value:function(t,e){var n=this.evaluateNode(t.object);return null==n&&(this.options.allowNull||t.object.allowNull)&&(n=new ht),t.computed?n[this.evaluateNode(t.property)]:this.evaluateNode(t.property,{target:n,targetNode:t.object,callee:e&&e.callee,assignmentLeft:e&&e.assignmentLeft})}},{key:"evaluateIdentifier",value:function(t,e){var n;if(n=null==(e=e||{}).targetNode?this.scope:e.target,e.assignmentLeft||e.callee)return{obj:n,prop:t.name};if(e.propertyKey)return t.name;var r=n[t.name];return null==r&&this.locals&&(r=this.locals[t.name]),r}},{key:"evaluateLiteral",value:function(t){return t.value}},{key:"evaluateProperty",value:function(t){return{key:this.evaluateNode(t.key,{propertyKey:!0}),value:this.evaluateNode(t.value)}}},{key:"evaluateObject",value:function(t){var e=this,n={};return t.properties.forEach((function(t){var r=e.evaluateNode(t);n[r.key]=r.value})),n}},{key:"evaluateArray",value:function(t){var e=this,n=[];return t.childNodes.forEach((function(t){n.push(e.evaluateNode(t))})),n}}])&&Be(e.prototype,n),r&&Be(e,r),t}();function Fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function We(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qe(t,e,n){return e&&We(t.prototype,e),n&&We(t,n),t}var Ke=function(){function t(e,n){Fe(this,t),this.callee=e,this.exp=n,this.children={}}return qe(t,[{key:"createChild",value:function(e,n,r){return this.children[e]||(this.children[e]=new t(n,r)),this.children[e]}}]),t}(),He=function(){function t(e,n){Fe(this,t),this.exp=e,this.locals=n||{},this.program=null,this.builder=new Re,this.accessors={}}return qe(t,[{key:"createAccessor",value:function(t,e,n){return this.accessors[t]||(this.accessors[t]=new Ke(e,n)),this.accessors[t]}},{key:"analyse",value:function(){var t=this;this.program=Ve(this.exp),this.program.childNodes.forEach((function(e){t.analyseNode(e)}))}},{key:"analyseNode",value:function(t,e){var n=null;switch(t.type){case ft.ExpressionStatement:this.analyseExpression(t);break;case ft.AssignmentExpression:this.analyseAssignment(t);break;case ft.ConditionalExpression:this.analyseCondition(t);break;case ft.LogicalExpression:this.analyseLogic(t);break;case ft.BinaryExpression:this.analyseBinary(t);break;case ft.UnaryExpression:this.analyseUnary(t);break;case ft.CallExpression:this.analyseCall(t);break;case ft.MemberExpression:n=this.analyseMember(t,e);break;case ft.Identifier:n=this.analyseIdentifier(t,e);break;case ft.Literal:n=this.analyseLiteral(t,e);break;case ft.ArrayExpression:this.analyseArray(t);break;case ft.Property:this.analyseProperty(t);break;case ft.ObjectExpression:this.analyseObject(t)}return n}},{key:"analyseExpression",value:function(t){var e=this;t.childNodes.forEach((function(t){e.analyseNode(t)}))}},{key:"analyseAssignment",value:function(t){this.analyseNode(t.right)}},{key:"analyseCondition",value:function(t){this.analyseNode(t.test),this.analyseNode(t.alternate),this.analyseNode(t.consequent)}},{key:"analyseLogic",value:function(t){this.analyseNode(t.left),this.analyseNode(t.right)}},{key:"analyseBinary",value:function(t){this.analyseNode(t.left),this.analyseNode(t.right)}},{key:"analyseUnary",value:function(t){this.analyseNode(t.arg)}},{key:"analyseCall",value:function(t){var e=this;t.args.forEach((function(t){e.analyseNode(t)})),t.filter||this.analyseNode(t.callee,{callee:!0})}},{key:"analyseMember",value:function(t,e){var n=this.analyseNode(t.object);if(t.computed){if(this.analyseNode(t.property,{callee:e&&e.callee}),t.property.type===ft.Literal)return n.createChild(t.property.value,e&&e.callee);var r=this.builder.build(t.property);return n.createChild(r,e&&e.callee,!0)}return this.analyseNode(t.property,{parent:n,callee:e&&e.callee})}},{key:"analyseIdentifier",value:function(t,e){var n=this.builder.build(t),r=e&&e.callee;return e&&e.parent?e.parent.createChild(n,r):this.locals[t.name]?void 0:this.createAccessor(n,r)}},{key:"analyseLiteral",value:function(t,e){var n=this.builder.build(t);if(e&&e.parent)return e.parent.createChild(n)}},{key:"analyseProperty",value:function(t){this.analyseNode(t.value)}},{key:"analyseObject",value:function(t){var e=this;t.properties.forEach((function(t){e.analyseNode(t)}))}},{key:"analyseArray",value:function(t){var e=this;t.childNodes.forEach((function(t){e.analyse(t)}))}}]),t}();function ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ye=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.onPropChanging=function(t){e.handlePropChanging(t)},this.onPropChanged=function(t){e.handlePropChanged(t)},this.listeners=[],this.validators=[],this.init()}var e,n,r;return e=t,(n=[{key:"init",value:function(){G.propChanging.on(this.onPropChanging),G.propChanged.on(this.onPropChanged)}},{key:"handlePropChanging",value:function(t){var e=this.getWatcher(this.validators,t.target);null!=e&&e.fireKey(t.key,t)}},{key:"handlePropChanged",value:function(t){var e=this.getWatcher(this.listeners,t.target);null!=e&&(e.fireKey(t.key,t),e.fireKey("*",t))}},{key:"getWatcher",value:function(t,e){var n,r=t.filter((function(t){return t.target===e}));return r.length>0&&(n=r[0]),n}},{key:"createWatcher",value:function(t,e){var n=new ct(e);return t.push(n),n}},{key:"getOrCreateWatcher",value:function(t,e){var n=this.getWatcher(t,e);return null==n&&(n=this.createWatcher(t,e)),n}},{key:"watch",value:function(t,e,n){var r=this.getOrCreateWatcher(this.listeners,t);return r.registerKey(e,n),function(){r.unregisterKey(e,n)}}},{key:"validate",value:function(t,e,n){var r=this.getOrCreateWatcher(this.validators,t);return r.registerKey(e,n),function(){r.unregisterKey(e,n)}}},{key:"watchExp",value:function(t,e,n){var r=this,i=new He(e),o=new Ue(t,{},{allowNull:!0});function u(t){a(t,(function(t){S(t.unwatch)&&(t.unwatch.call(this),t.unwatch=null),u(t.children)}))}return i.analyse(),function t(i,s){k(s)&&a(i,(function(i,a){i.exp&&(a=o.evaluate(a)),i.unwatch=r.watch(s,a,(function(r){u(i.children),t(i.children,r.data.newValue),n.call(this,{newValue:o.evaluate(e)})})),t(i.children,s[a])}))}(i.accessors,t),function(){u(i.accessors)}}},{key:"watchCollection",value:function(t,e,n){var r=arguments,i=this,o=this,a=new Ue(t,{},{allowNull:!0}),u=c(),s=this.watchExp(t,e,(function(){null!=u&&u.call(i),u=c(),n.apply(i,r)}));function c(){var t=a.evaluate(e);if(k(t)||g(t))return o.watch(t,"*",n)}return function(){s.call(this),u&&u.call(this)}}},{key:"destroy",value:function(){this.listeners.length=0,this.validators.length=0,G.propChanging.off(this.onPropChanging),G.propChanged.off(this.onPropChanged)}}])&&ze(e.prototype,n),r&&ze(e,r),t}();function Ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ge=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodeName=e,this.nodeValue=n,this.childNodes=[],this.parentNode=null,this.previousSibling=null,this.nextSibling=null,this.firstChild=null,this.lastChild=null,this.data={}}var e,n,r;return e=t,(n=[{key:"pushChild",value:function(t){t.parentNode=this,this.childNodes.push(t)}},{key:"buildSibling",value:function(){if(0!==this.childNodes.length){var t=this;1===this.childNodes.length?(this.firstChild=this.childNodes[0],this.lastChild=this.childNodes[0]):(this.firstChild=this.childNodes[0],this.lastChild=this.childNodes[this.childNodes.length-1],this.childNodes.forEach((function(e,n){0!==n?n!==t.childNodes.length-1?(e.previousSibling=t.childNodes[n-1],e.nextSibling=t.childNodes[n+1]):e.previousSibling=t.childNodes[n-1]:e.nextSibling=t.childNodes[n+1]}))),this.childNodes.forEach((function(t){t.buildSibling()}))}}},{key:"clearParentAndSibling",value:function(){this.parentNode=null,this.previousSibling=null,this.nextSibling=null}},{key:"remove",value:function(){null!=this.parentNode&&this.parentNode.removeChild(this)}},{key:"hasChildNodes",value:function(){return 0!==this.childNodes.length}},{key:"clearChildNodes",value:function(){this.childNodes.forEach((function(t){t.destroy()})),this.childNodes.length=0}},{key:"appendChild",value:function(t){return null!=t.parentNode&&t.parentNode.removeChild(t),t.parentNode=this,0===this.childNodes.length?this.firstChild=t:(this.lastChild.nextSibling=t,t.previousSibling=this.lastChild),t.compile(this.compileOptions),this.lastChild=t,this.childNodes.push(t),t}},{key:"insertBefore",value:function(t,e){null!=e.parentNode&&e.parentNode.removeChild(e);var n=this.childNodes.indexOf(t);if(-1===n)throw new Error("Ref node is not a child of specified node");return e.parentNode=this,null!=t.previousSibling&&(e.previousSibling=t.previousSibling,t.previousSibling.nextSibling=e),e.nextSibling=t,t.previousSibling=e,0===n&&(this.firstChild=e),e.compile(this.compileOptions),this.childNodes.splice(n,0,e),e}},{key:"insertAfter",value:function(t,e){return null==t.nextSibling?this.appendChild(e):this.insertBefore(t.nextSibling,e)}},{key:"removeChild",value:function(t){var e=this.childNodes.indexOf(t);if(-1===e)throw new Error("Remove node is not a child of specified node");return null!=t.previousSibling&&(t.previousSibling.nextSibling=t.nextSibling),null!=t.nextSibling&&(t.nextSibling.previousSibling=t.previousSibling),0===e&&(this.firstChild=t.nextSibling),e===this.childNodes.length-1&&(this.lastChild=t.previousSibling),t.clearParentAndSibling(),this.childNodes.splice(e,1),t}},{key:"replaceChild",value:function(t,e){null!=e.parentNode&&e.parentNode.removeChild(e);var n=this.childNodes.indexOf(t);if(-1===n)throw new Error("Ref node is not a child of specified node");return e.parentNode=this,e.previousSibling=t.previousSibling,e.nextSibling=t.nextSibling,this.firstChild===t&&(this.firstChild=e),this.lastChild===t&&(this.lastChild=e),t.clearParentAndSibling(),e.compile(this.compileOptions),this.childNodes.splice(n,1,e),e}},{key:"cloneNode",value:function(){throw new Error("not implemented")}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy(),this.childNodes.map((function(t){t.destroy()})),this.remove(),this.clearParentAndSibling(),this.childNodes.length=0,this.firstChild=null,this.lastChild=null,this.ownerDocument=null}}])&&Ze(e.prototype,n),r&&Ze(e,r),t}();function Je(t){return(Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xe(t,e){return!e||"object"!==Je(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tn(t){return(tn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function en(t,e){return(en=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nn=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Xe(this,tn(e).call(this,t,n))).velm=null,r.quote='"',r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&en(t,e)}(e,t),n=e,(r=[{key:"setValue",value:function(t){this.nodeValue=t}},{key:"onDdestroy",value:function(){}}])&&Qe(n.prototype,r),i&&Qe(n,i),e}(Ge);function rn(t){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function on(t,e){return!e||"object"!==rn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function un(t,e){return(un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),on(this,an(e).call(this,"#comment",t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&un(t,e)}(e,t),e}(Ge);function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fn(t,e){return!e||"object"!==cn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hn(t){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pn(t,e){return(pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),fn(this,hn(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pn(t,e)}(e,t),n=e,(r=[{key:"isValidIdentifierStart",value:function(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"||"_"===t||"$"===t||"@"===t||":"===t||"*"===t}},{key:"isValidIdentifierContinue",value:function(t,e){return this.isValidIdentifierStart(t,e)||this.isNumber(t)||"-"===t||"."===t}},{key:"expectString",value:function(t){var e=t.length;return this.index+e<=this.text.length&&t===this.text.substr(this.index,e)}},{key:"readComment",value:function(t,e){var n=this.index;this.index+=t.length;for(var r="",i=t;this.index<this.text.length;){var o=this.text.charAt(this.index);if(i+=o,this.expectString(e))return i+=e,this.index+=e.length,void this.tokens.push({index:n,text:i,comment:!0,value:r});r+=o,this.index++}this.throwError("Unterminated comment",n)}},{key:"readText",value:function(){for(var t=this.index,e="";this.index<this.text.length;){var n=this.text.charAt(this.index),r=this.peek();if("<"===n&&(this.isIdentifierStart(r)||"/"===r)||this.expectString("\x3c!--"))break;e+=n,this.index++}this.tokens.push({index:t,text:e,textTag:!0})}},{key:"readTag",value:function(t,e,n,r){for(this.tokens.push({index:this.index,text:t,tag:!0,closing:n,begin:!0,doctype:r}),this.index+=t.length,this.readIdent();this.index<this.text.length;){var i=this.text.charAt(this.index);if(!n){var o=i+this.peek();if(o==="/"+e){this.tokens.push({index:this.index,text:o,tag:!0,closing:!0,end:!0}),this.index+=o.length;break}}if(i===e){this.tokens.push({index:this.index,text:e,tag:!0,closing:!!r||n,end:!0}),this.index+=e.length;break}this.isIdentifierStart(this.peekMultichar())?this.readIdent():'"'===i||"'"===i?this.readString(i):this.isWhitespace(i)?this.index++:"="===i?(this.tokens.push({index:this.index,text:"=",equal:!0}),this.index++):this.throwError("Unexpected next character ",this.index,this.index+1)}}},{key:"lex",value:function(t){this.text=t,this.index=0,this.tokens=[];for(var e=!!this.options.allowDocType;this.index<this.text.length;){var n=this.text.charAt(this.index),r=this.peek(),i=this.peek(2);this.expectString("\x3c!--")?this.readComment("\x3c!--","--\x3e"):"<"===n&&this.isIdentifierStart(r)?this.readTag("<",">",!1):this.expectString("</")&&this.isIdentifierStart(i)?this.readTag("</",">",!0):this.expectString("<!DOCTYPE")?e?this.readTag("<!",">",!0,!0):this.throwError("DOCTYPE is not allowed",this.index,this.index+1):this.readText()}return this.tokens}}])&&ln(n.prototype,r),i&&ln(n,i),e}(Ae);function dn(t){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bn(t,e){return!e||"object"!==dn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mn(t){return(mn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gn(t,e){return(gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kn=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),bn(this,mn(e).call(this,t,n))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gn(t,e)}(e,t),n=e,(r=[{key:"parse",value:function(t){this.index=0,this.text=t,this.tokens=this.lexer.lex(t);for(var e,n=new $n,r=!!this.options.allowDocType;this.index<this.tokens.length;){var i=this.current();if(i.doctype)r?e?this.throwError("DOCTYPE only allow one",i):(e=this.doctype(),n.childNodes.push(e)):this.throwError("DOCTYPE is not allowed",i);else if(i.comment){var o=new sn(i.text);n.childNodes.push(o),this.next()}else i.textTag?(t=new An(i.text),n.childNodes.push(t),this.next()):i.tag&&i.begin?n.childNodes.push(this.element()):this.throwError("impossible",i)}return n.buildSibling(),n.childNodes}},{key:"doctype",value:function(){this.next();var t=new Mn,e=this.current();return e.identifier?t.nodeValue=e.text:this.throwError(" Unexpected ",e),this.attrs(t).forEach((function(e){t.childNodes.push(e)})),(e=this.current()).tag&&e.end&&e.closing?this.next():this.throwError(" Unexpected ",e),t}},{key:"element",value:function(t){this.next();var e=new $n,n=this.current();if(n.identifier?(e.nodeName=n.text,this.next()):this.throwError(" Unexpected ",n),this.attrs(e).forEach((function(t){e.pushAttr(t)})),(n=this.current()).tag&&n.end){if(this.next(),"input"===e.nodeName)return e.selfClosed=!0,e;n.closing||this.childElements(e).forEach((function(t){e.pushChild(t)}))}else this.throwError(" Unexpected ",n);return(n=this.current()).tag&&n.begin&&n.closing?(this.next(),(n=this.current()).identifier&&e.nodeName===n.text?(this.next(),(n=this.current()).tag&&n.end&&n.closing?this.next():this.throwError(" Unexpected ",n)):this.throwError(" Unexpected ",n)):this.throwError(" Unexpected ",n),e}},{key:"childElements",value:function(t){for(var e=[];this.index<this.tokens.length;){var n=this.current();if(n.tag&&n.closing)break;if(n.comment){var r=new sn(n.text);e.push(r),this.next()}else if(n.textTag){var i=new An(n.text);e.push(i),this.next()}else n.tag&&n.begin?e.push(this.element(t)):this.throwError(" Unexpected ",n)}return e}},{key:"attrs",value:function(t){for(var e=[];this.index<this.tokens.length;){var n=this.current();if(n.tag&&n.end)break;var r=new nn;n.identifier&&(r.nodeName=n.text,r.origin=n.text,this.next(),(n=this.current()).equal&&(this.next(),(n=this.current()).constant?(r.nodeValue=n.value,this.next()):this.throwError(" Unexpected ",n))),e.push(r)}return e}},{key:"current",value:function(){return this.index<this.tokens.length?this.tokens[this.index]:{}}},{key:"next",value:function(){this.index++}}])&&vn(n.prototype,r),i&&vn(n,i),e}(De);function xn(t){return t=F(t),(new yn).lex(t)}function wn(t){return t=F(t),new kn(new yn).parse(t)}function En(t){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function On(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Sn(t,e){return!e||"object"!==En(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cn(t){return(Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jn(t,e){return(jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $n=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Sn(this,Cn(e).call(this,t))).vattrs=[],n.selfClosed=!1,n.elm=null,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jn(t,e)}(e,t),n=e,(r=[{key:"pushAttr",value:function(t){t.velm=this,this.vattrs.push(t)}},{key:"hasAttr",value:function(){return 0!==this.vattrs.length}},{key:"getAttr",value:function(t){var e=this.vattrs.filter((function(e){return e.belongTo(t)}));return e.length?e[0]:null}},{key:"setAttr",value:function(t,e){var n,r=this.vattrs.filter((function(e){return e.belongTo(t)}));return r.length>0?(n=r[0]).setValue(e):((n=new nn(t,e)).velm=this,n.compile(this.compileOptions)),this.vattrs.push(n),n}},{key:"removeAttr",value:function(t){var e=[],n=this;if(t instanceof nn){var r=this.vattrs.indexOf(t);-1!==r&&(e=n.vattrs.splice(r,1))}else this.vattrs.filter((function(e){return e.belongTo(t)})).forEach((function(t){var r=n.vattrs.indexOf(t);t.destroy(),e=n.vattrs.splice(r,1)}));return e.length>0?e[0]:null}},{key:"appendAttr",value:function(t){if(null!=t.velm)throw new Error("Current attribute is not new!");return t.velm=this,t.compile(this.compileOptions),this.vattrs.push(t),t}},{key:"setOuterTpl",value:function(t){var e=this;wn(t).forEach((function(t){t.parentNode=null,e.parentNode.insertBefore(e,t)})),e.parentNode.removeChild(e)}},{key:"setInnerTpl",value:function(t){var e=this;this.clearChildNodes(),wn(t).forEach((function(t){t.parentNode=null,e.appendChild(t)}))}},{key:"onDestroy",value:function(){this.vattrs.forEach((function(t){t.destroy()})),this.vattrs.length=0}}])&&On(n.prototype,r),i&&On(n,i),e}(Ge);function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _n(t,e){return!e||"object"!==Nn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pn(t){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tn(t,e){return(Tn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var An=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_n(this,Pn(e).call(this,"#text",t))).elm=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tn(t,e)}(e,t),e}(Ge);function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ln(t){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vn(t,e){return(Vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Dn(this,Ln(e).call(this))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vn(t,e)}(e,t),e}(Ge);function Rn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"build",value:function(t){return this.isText(t)?this.buildText(t):this.isComment(t)?this.buildComment(t):this.buildElement(t)}},{key:"isText",value:function(t){return"#text"===t.nodeName}},{key:"isComment",value:function(t){return"#comment"===t.nodeName}},{key:"buildElement",value:function(t){var e=this,n=t.vattrs.map((function(t){return e.buildAttribute(t)})).join(" "),r=t.childNodes.map((function(t){return e.build(t)})).join("");n&&(n=" "+n);var i="<"+t.nodeName+n+">"+r;return t.selfClosed||(i+="</"+t.nodeName+">"),i}},{key:"buildAttribute",value:function(t){return t.nodeName+(null==t.nodeValue?"":"="+t.quote+t.nodeValue+t.quote)}},{key:"buildText",value:function(t){return t.nodeValue}},{key:"buildComment",value:function(t){return this.nodeValue}}])&&Rn(e.prototype,n),r&&Rn(e,r),t}();function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fn=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scope=e,this.text=n,this.locals=r}var e,n,r;return e=t,(n=[{key:"mergeLocals",value:function(t){return l({},this.locals,t)}},{key:"compute",value:function(t){return new Ue(this.scope,this.mergeLocals(t)).evaluate(this.text)}},{key:"assign",value:function(t,e){new Ue(this.scope,this.mergeLocals(e),{assignInterceptor:function(e,n){e.delegate((function(e){e[n]=t}))}}).evaluate(this.text,t)}},{key:"watch",value:function(t){return this.scope.$watchExp(this.text,t)}},{key:"destroy",value:function(){}}])&&Un(e.prototype,n),r&&Un(e,r),t}();function Wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qn=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scope=e,this.text=n,this.locals=r,this.expressed=!1,this.messaged=!1,this.assigned=!1,this.automation=null,this.value=null,this.changed=!1,this.segments=[],this.expressions=[]}var e,n,r;return e=t,(n=[{key:"createExpression",value:function(t){var e=new Fn(this.scope,t,this.locals);return this.expressions.push(e),e}},{key:"compile",value:function(){if((this.messaged||this.assigned)&&(this.expressed=!0),this.expressed)this.createExpression(this.text);else{for(var t,e=/{{([^}]*)}}/g,n=e.lastIndex,r=e.exec(this.text);null!=r;)r.index>n&&(t=this.text.substring(n,r.index),this.segments.push(t)),this.segments.push(this.createExpression(r[1])),n=e.lastIndex,r=e.exec(this.text);this.text.length>n&&(t=this.text.substring(n),this.segments.push(t))}}},{key:"link",value:function(){var t=this;this.assigned||this.messaged||(this.detect(),this.expressions.forEach((function(e){e.watch((function(){t.detect(),t.scope.$patch()}))})))}},{key:"detect",value:function(){var t=this.compute();this.value!=t&&(this.changed=!0,this.value=t)}},{key:"compute",value:function(t){return this.expressed?this.expressions[0].compute(t):this.segments.reduce((function(e,n){return w(n)?e+n:e+n.compute(t)}),"")}},{key:"assign",value:function(t,e){new Evaluator(this.scope,e,{assignInterceptor:function(e,n){e.delegate((function(e){e[n]=t}))}}).evaluate(this.text,t)}},{key:"registerAutomation",value:function(t){this.automation=t}},{key:"unregisterAutomation",value:function(t){this.automation===t&&(this.automation=null)}},{key:"patch",value:function(){this.changed&&null!=this.automation&&(this.changed=!1,this.automation.call(this,this.value))}},{key:"destroy",value:function(){}}])&&Wn(e.prototype,n),r&&Wn(e,r),t}();function Kn(t){return Array.prototype.slice.call(t.childNodes,0)}function Hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var zn="load unload change submit reset select blur focus abort keydown keypress keyup click dblclick mousedown mousemove mouseout mouseover mouseup".split(" "),Yn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scope=e,this.locals=n,this.vnodes=[],this.directives=[]}var e,n,r;return e=t,(n=[{key:"createBinding",value:function(t){var e=new qn(this.scope,t,this.locals);return this.scope.$$bindings.push(e),e}},{key:"render",value:function(t){var e=document.createDocumentFragment();return this.vnodes=wn(t),this.compileNodes(this.vnodes),this.linkNodes(this.vnodes).forEach((function(t){e.appendChild(t)})),this.directives.forEach((function(t){t.$postlink()})),e}},{key:"isText",value:function(t){return"#text"===t.nodeName}},{key:"isComment",value:function(t){return"#comment"===t.nodeName}},{key:"compileNodes",value:function(t){var e=this;t.forEach((function(t){e.compileNode(t)}))}},{key:"compileNode",value:function(t){this.isText(t)?this.compileText(t):this.isComment(t)?this.compileComment(t):this.compileElm(t)}},{key:"linkNodes",value:function(t){var e=this;return t.map((function(t){return e.linkNode(t)}))}},{key:"linkNode",value:function(t){return this.isText(t)?this.linkText(t):this.isComment(t)?this.linkComment(t):this.linkElm(t)}},{key:"compileElm",value:function(t){var e=this,n=[],r=t.vattrs.some((function(r){return e.compileAttr(r),null!=r.data.directive&&(n.push(r.data.directive),t.data.linker=r.data.linker,null!=t.data.linker)}));V(n,(function(t){return t.$priority})).forEach((function(t){e.directives.push(t)})),r||(t.data.isComponent=this.scope.$hasComponent(t.nodeName),t.data.isComponent||this.compileNodes(t.childNodes))}},{key:"compileAttr",value:function(t){if(t.data.binding=this.createBinding(t.nodeValue),t.nodeName.startsWith("@")?(t.data.messaged=!0,t.data.binding.messaged=!0,t.data.key=t.nodeName.substr(1),t.data.domMessaged=P(zn,t.data.key)):t.nodeName.startsWith(":")?(t.data.binding.expressed=!0,t.data.key=t.nodeName.substr(1)):t.nodeName.startsWith("*")?(t.data.isDirective=!0,t.data.binding.expressed=!0,t.data.key=t.nodeName.substr(1)):t.data.key=t.nodeName,t.data.isDirective){if(!this.scope.$hasDirective(t.data.key))throw new Error("directive "+t.data.key+" is not defined");if(t.data.directive=this.scope.$newDirective(t.data.key),t.data.directive.$$vattr=t,t.data.binding.assigned=t.data.directive.$assigned,t.data.directive.$compile())return void(t.data.linker=t.data.directive)}if(t.data.isDirective)t.data.binding.registerAutomation((function(e){t.data.directive.$change(e)}));else if(!t.data.messaged){var e=function(e){var n=t.velm.elm;t.data.key.startsWith("style")?D(n,t.data.key,e):n.setAttribute(t.data.key,e)};t.velm.isComponent?t.data.binding.registerAutomation((function(n){t.velm.component.$hasAttribute(t.data.key)?t.velm.component.$setAttribute(t.data.key,n):e(n)})):t.data.binding.registerAutomation(e)}t.data.binding.compile()}},{key:"compileText",value:function(t){t.data.binding=this.createBinding(t.nodeValue),t.data.binding.registerAutomation((function(e){var n,r,i,o,a=document.createTextNode(e);null==t.parentNode?null!=t.elm&&(n=t.elm.parentNode):n=t.parentNode.elm,null!=n&&(null==t.elm?n.appendChild(a):(r=t.elm,i=a,null!=(o=r.parentNode)&&(o.insertBefore(i,r),o.removeChild(r)))),t.elm=a})),t.data.binding.compile()}},{key:"compileComment",value:function(t){}},{key:"linkElm",value:function(t){var e=this;if(null!=t.data.linker)return t.data.linker.$link();if(t.elm=document.createElement(t.nodeName),t.data.isComponent){var n=this.scope.$newComponent(t.nodeName);t.data.component=n,t.elm.style.display=n.$display,t.vattrs.forEach((function(t){e.linkAttr(t)})),n.$$velm=t,n.$render(),n.$mount(t.elm)}else t.vattrs.forEach((function(t){e.linkAttr(t)})),t.childNodes.forEach((function(n){t.elm.appendChild(e.linkNode(n))}));return t.elm}},{key:"linkAttr",value:function(t){var e=t.velm.elm;t.data.messaged?t.data.domMessaged?e.addEventListener(t.data.key,(function(n){t.data.binding.compute({locals:new q(n,e)})})):t.velm.isComponent&&t.velm.component.$bind(t.data.key,(function(n,r){t.data.binding.compute({locals:new q(n,e,r)})})):(t.data.binding.link(),t.data.binding.patch())}},{key:"linkText",value:function(t){return t.data.binding.link(),t.elm=document.createTextNode(t.data.binding.value),t.elm}},{key:"linkComment",value:function(t){return document.createComment(t.nodeValue)}}])&&Hn(e.prototype,n),r&&Hn(e,r),t}(),Zn=0,Gn=1,Jn=2,Qn=3;function Xn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var tr=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.classContainer={},this.instanceContainer={}}var e,n,r;return e=t,(n=[{key:"getClassContainer",value:function(t){return this.classContainer[t]||(this.classContainer[t]={}),this.classContainer[t]}},{key:"getInstanceContainer",value:function(t){return this.instanceContainer[t]||(this.instanceContainer[t]=[]),this.instanceContainer[t]}},{key:"register",value:function(t,e,n,r){if(-1!==e.indexOf("."))throw new Error('Illegal character "."');r.key=e,n.prototype.$$metadata=r;var i=this.getClassContainer(t);if(null==i[e])i[e]=[];else{var o=i[e].filter((function(t){return t.prototype.$$metadata.namespace===n.prototype.$$metadata.namespace}));if(o.length>0)throw new Error(e+" is exist under namespace "+o[0].prototype.$$metadata.namespace)}i[e].push(n)}},{key:"registerComponent",value:function(t,e,n){this.register(Jn,t,e,n)}},{key:"registerDirective",value:function(t,e,n){this.register(Qn,t,e,n)}},{key:"registerFilter",value:function(t,e,n){this.register(Zn,t,e,n)}},{key:"registerService",value:function(t,e,n){this.register(Gn,t,e,n)}},{key:"has",value:function(t,e,n){var r,i=this.getClassContainer(t),o=e.split("."),a="";return o.length>1&&(e=o.pop(),a=o.join(".")),null!=(r=n?I(i,e,!0):i[e])&&!(a&&r.length>0&&0===(r=r.filter((function(t){var e=t.prototype.$$metadata;return e.namespace&&d(e.namespace)===d(a)}))).length)}},{key:"hasComponent",value:function(t){return this.has(Jn,t,!0)}},{key:"hasDirective",value:function(t){return this.has(Qn,t,!0)}},{key:"hasFilter",value:function(t){return this.has(Zn,t,!0)}},{key:"hasService",value:function(t){return this.has(Gn,t,!0)}},{key:"get",value:function(t,e,n){var r,i=this.getClassContainer(t),o=e.split("."),a="";if(o.length>1&&(e=o.pop(),a=o.join(".")),null==(r=n?I(i,e,!0):i[e]))throw new Error(t+" "+e+" is not defined");if(a&&r.length>0&&0===(r=r.filter((function(t){var e=t.prototype.$$metadata;return e.namespace&&d(e.namespace)===d(a)}))).length)throw new Error(e+" is not exist under namespace "+a);if(r.length>1){var u=r.map((function(t){return t.prototype.$$metadata.namespace}));throw new Error("namespace "+u.join("|")+" all have "+e)}return r[0]}},{key:"getComponent",value:function(t){return this.get(Jn,t)}},{key:"getDirective",value:function(t){return this.get(Qn,t)}},{key:"getFilter",value:function(t){return this.get(Zn,t)}},{key:"getService",value:function(t){return this.get(Gn,t)}},{key:"create",value:function(t,e){var n;if(w(e)){if(null==(n=this.get(t,e)))throw new Error("miss constructor for key "+e)}else{if(!S(e))throw new Error("Invalid parameter");n=e}return new n}},{key:"createComponent",value:function(t){return this.create(Jn,t)}},{key:"createDirective",value:function(t){return this.create(Qn,t)}},{key:"createFilter",value:function(t){var e,n=this.getInstanceContainer(Zn);w(t)&&(t=this.getFilter(t));var r=n.filter((function(e){return e instanceof t}));return r.length?e=r[0]:(e=new t,n.push(e)),e}},{key:"createService",value:function(t){var e,n=this.getInstanceContainer(Gn);if(w(t)&&(t=this.getService(t)),!t.prototype.$$metadata.nonShared){var r=n.filter((function(e){return e instanceof t}));r.length&&(e=r[0])}return e||(e=new t,n.push(e)),e}},{key:"injectServices",value:function(t){var e=this,n=t.$$metadata;n&&k(n.inject)&&a(n.inject,(function(n,r){Object.defineProperty(t,r,{enumerable:!1,configurable:!1,get:function(){var i="$$"+r;return null==t[i]&&(t[i]=e.createService(n)),t[i]}})}))}}])&&Xn(e.prototype,n),r&&Xn(e,r),t}());function er(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var nr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.timeout=n,this.delayId=null}var e,n,r;return e=t,(n=[{key:"execute",value:function(t){var e=this;null==this.delayId&&(this.delayId=setTimeout((function(){e.delayId=null,e.handler.call(t)}),this.timeout))}},{key:"destroy",value:function(){null!=this.delayId&&clearTimeout(this.delayId)}}])&&er(e.prototype,n),r&&er(e,r),t}();function rr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ir(t){this.$$data=null,this.$$velm=null,this.$$fragment=null,this.$$bindings=[],this.$$parent=null,this.$$children=[],this.$$directives=[],this.$$injector=tr,this.$$render=new Yn(this),this.$$observer=new Ye(this),this.$$evaluator=new Ue(this),this.$$delayer=new nr(this.$$doPatch),this.$display="block",this.$setData(t),tr.injectServices(this)}var or=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ir.call(this,e)}var e,n,r;return e=t,(n=[{key:"$setData",value:function(t){null!=t&&(S(t.construct)&&t.construct.call(this,H),k(t.methods)&&c(this,t.methods)),this.$$data=l(this.$$metadata,t)}},{key:"$hasComponent",value:function(t){return this.$$injector.hasComponent(t)}},{key:"$newComponent",value:function(t){var e=this.$$injector.createComponent(t);return e.$$parent=this,this.$$children.push(e),e}},{key:"$hasDirective",value:function(t){return this.$$injector.hasDirective(t)}},{key:"$newDirective",value:function(t){var e=this.$$injector.createDirective(t);return e.$$scope=this,this.$$directives.push(e),e}},{key:"$hasFilter",value:function(t){return this.$$injector.hasFilter(t)}},{key:"$getFilter",value:function(t){return this.$$injector.createFilter(t)}},{key:"$hasAttribute",value:function(t){return A(this,t,!0)}},{key:"$setAttribute",value:function(t,e){I(this,t,!0)!==e&&D(this.delegate(),t,e,!0)}},{key:"$bind",value:function(t,e){if(!z(t=I(this,t,!0)))throw new Error(t+" is not a message");t.on(e)}},{key:"$unbind",value:function(t,e){var n=I(this,n,!0);if(!z(n))throw new Error(n+" is not a message");n.off(e)}},{key:"$watch",value:function(t,e){return this.$$observer.watch(this,t,e)}},{key:"$validate",value:function(t,e){return this.$$observer.validate(this,t,e)}},{key:"$watchExp",value:function(t,e){return this.$$observer.watchExp(this,t,e)}},{key:"$watchCollection",value:function(t,e){return this.$$observer.watchCollection(this,t,e)}},{key:"$eval",value:function(t){return this.$$evaluator.evaluate(t)}},{key:"$getTemplate",value:function(){var t=this.$$data;if(w(t.template))return t.template;if(w(t.templateId)){var e=document.getElementById(t.templateId);if(null!=e)return e.innerHTML}return""}},{key:"$render",value:function(){var t=this.$getTemplate();return this.$$fragment=this.$$render.render(t),this.$$fragment}},{key:"$mount",value:function(t){(w(t)?document.querySelector(t):t).appendChild(this.$$fragment)}},{key:"$unmount",value:function(){}},{key:"$patch",value:function(){this.$$delayer.execute(this)}},{key:"$$doPatch",value:function(){this.$$bindings.forEach((function(t){t.patch()}))}},{key:"$destroy",value:function(){this.$$delayer.destroy(),this.$$observer.destroy(),this.$$children.forEach((function(t){t.$destroy()})),this.$$directives.forEach((function(t){t.$destroy()})),this.$$bindings.forEach((function(t){t.destroy()})),this.onDestroy&&this.onDestroy(),this.$$parent=null,this.$$children.length=0,this.$$directives.length=0,this.$$bindings.length=0}}])&&rr(e.prototype,n),r&&rr(e,r),t}();function ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ur(t,e,n){return e&&ar(t.prototype,e),n&&ar(t,n),t}function sr(){this.$$scope=null,this.$$vattr=null,this.$assigned=!1,this.$priority=9}var cr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),sr.call(this,e)}return ur(t,[{key:"$scope",get:function(){return this.$$scope}},{key:"$elm",get:function(){return this.$$vattr.velm.elm}},{key:"$binding",get:function(){return this.$$vattr.data.binding}}]),ur(t,[{key:"$compile",value:function(){return this.onCompile&&this.onCompile(this.$$vattr.velm,this.$$vattr)}},{key:"$change",value:function(t){this.onChange&&this.onChange(t)}},{key:"$link",value:function(){return this.onLink&&this.onLink(this.$scope)}},{key:"$postlink",value:function(){this.afterLink&&this.afterLink()}},{key:"$destroy",value:function(){this.onDestroy&&this.onDestroy()}}]),t}();function lr(t){}var fr=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),lr.call(this,e)};function hr(t){}var pr=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),hr.call(this,e)};function yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dr=/^[a-z_\$][\w\$-]*/i,vr=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"rename",value:function(t,e){if(dr.test(e)){var n="";switch(e.split("-").forEach((function(t){n+=v(t[0])+t.substring(1)})),t){case Jn:n+="Component";break;case Qn:n+="Directive";break;case Zn:n+="Filter";break;case Gn:n+="Service"}return n}throw new Error(e+"is not a valid name")}},{key:"make",value:function(t,e){var n,r=this.rename(t,e.key);return n=new Function("onConstruct",'"use strict";return function '+r+"(){onConstruct.call(this);};")((function(){S(n.super)&&n.super.call(this),S(e.construct)&&e.construct.call(this,H)})),S(e.extends)&&y(n,e.extends),k(e.methods)&&c(n.prototype,e.methods),n}},{key:"makeComponent",value:function(t){return this.make(Jn,t)}},{key:"makeDirective",value:function(t){return this.make(Qn,t)}},{key:"makeFilter",value:function(t){return this.make(Zn,t)}},{key:"makeService",value:function(t){return this.make(Gn,t)}}])&&yr(e.prototype,n),r&&yr(e,r),t}()),br=function(t){ir.call(this,t)};br.prototype=or.prototype;var mr=function(t){sr.call(this,t)};mr.prototype=cr.prototype;var gr=function(t){lr.call(this,t)};gr.prototype=fr.prototype;var kr,xr=function(t){hr.call(this,t)};function wr(t){return{component:function(e,n){return n.namespace=t,function(t,e){e.extends=br;var n=vr.makeComponent(e);return tr.registerComponent(t,n,e),n}(e,n)},directive:function(e,n){return n.namespace=t,function(t,e){e.extends=mr;var n=vr.makeDirective(e);return tr.registerDirective(t,n,e),n}(e,n)},service:function(e,n){return n.namespace=t,function(t,e){e.extends=xr;var n=vr.makeService(e);return tr.registerService(t,n,e),n}(e,n)},filter:function(e,n){return n.namespace=t,function(t,e){e.extends=gr;var n=vr.makeFilter(e);return tr.registerFilter(t,n,e),n}(e,n)}}}function Er(t){return t instanceof or}function Or(t){return t instanceof cr}function Sr(t){return t instanceof fr}function Cr(t){return t instanceof pr}function jr(t,e){var n,r=document.querySelector(t),i=new or(l({template:r.innerHTML},e));Kn(n=r).forEach((function(t){n.removeChild(t)})),i.$render(),i.$mount(r)}function $r(t){return function(e){var n=t.key||e.name;tr.registerComponent(n,e,t)}}function Nr(t){return function(e){var n=t.key||e.name;tr.registerDirective(n,e,t)}}function _r(t){return function(e){var n=t.key||e.name;tr.registerFilter(n,e,t)}}function Pr(t){return function(e){var n=t.key||e.name;tr.registerService(n,e,t)}}function Tr(t){return(Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ir(t,e){return!e||"object"!==Tr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dr(t){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lr(t,e){return(Lr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}xr.prototype=pr.prototype;var Vr;Nr({namespace:"automate",key:"m-bind"})(kr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ir(this,Dr(e).call(this))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lr(t,e)}(e,t),n=e,(r=[{key:"onChange",value:function(t){this.$elm.innerText=t}}])&&Ar(n.prototype,r),i&&Ar(n,i),e}(cr));function Mr(t){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Br(t,e){return!e||"object"!==Mr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ur(t){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fr(t,e){return(Fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Nr({namespace:"automate",key:"m-repeat"})(Vr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Br(this,Ur(e).call(this))).itemExp="",t.itemsExp="",t.itemTemplate="",t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fr(t,e)}(e,t),n=e,(r=[{key:"onCompile",value:function(t,e){var n=e.nodeValue,r=/^([a-z_]+\w+)\s+in\s+(.+)$/i.exec(n);if(null==r)throw new Error("m-repeat: parameter is not valid");this.itemExp=r[1],this.itemsExp=r[2];var i=new Bn;return t.removeAttr(e),this.itemTemplate=i.build(t),!0}},{key:"onLink",value:function(t){var e=this,n=document.createDocumentFragment(),r=document.createComment("start: m-repeat"),i=document.createComment("end: m-repeat");return n.appendChild(r),n.appendChild(this.render(t)),n.appendChild(i),t.$watchCollection(this.itemsExp,(function(){var o,a,u;n=e.render(t),a=i,Kn(u=(o=r).parentNode).forEach((function(t){t.previousSibling===o&&t!==a&&u.removeChild(t),t.nextSibling===a&&t!==o&&u.removeChild(t)})),i.parentNode.insertBefore(n,i)})),n}},{key:"render",value:function(t){var e=this,n=t.$eval(this.itemsExp),r=document.createDocumentFragment();return a(n,(function(n,i){var o={};o.$key=i,o.$index=i,o[e.itemExp]=n;var a=new Yn(t,o).render(e.itemTemplate);r.appendChild(a)})),r}},{key:"onDestroy",value:function(){}}])&&Rr(n.prototype,r),i&&Rr(n,i),e}(cr));n.d(e,"forEach",(function(){return a})),n.d(e,"some",(function(){return u})),n.d(e,"copy",(function(){return s})),n.d(e,"extend",(function(){return c})),n.d(e,"merge",(function(){return l})),n.d(e,"object",(function(){return p})),n.d(e,"inherit",(function(){return y})),n.d(e,"lowercase",(function(){return d})),n.d(e,"uppercase",(function(){return v})),n.d(e,"isUndefined",(function(){return b})),n.d(e,"isDefined",(function(){return m})),n.d(e,"isObject",(function(){return k})),n.d(e,"isBlankObject",(function(){return x})),n.d(e,"isNumber",(function(){return E})),n.d(e,"isDate",(function(){return O})),n.d(e,"isFunction",(function(){return S})),n.d(e,"isRegExp",(function(){return C})),n.d(e,"isBoolean",(function(){return j})),n.d(e,"isArray",(function(){return g})),n.d(e,"isString",(function(){return w})),n.d(e,"isSame",(function(){return N})),n.d(e,"isFormData",(function(){return $})),n.d(e,"debug",(function(){return _})),n.d(e,"contains",(function(){return P})),n.d(e,"containsStr",(function(){return T})),n.d(e,"hasProperty",(function(){return A})),n.d(e,"getProperty",(function(){return I})),n.d(e,"setProperty",(function(){return D})),n.d(e,"concat",(function(){return L})),n.d(e,"orderBy",(function(){return V})),n.d(e,"orderByDescending",(function(){return M})),n.d(e,"toNumber",(function(){return R})),n.d(e,"remove",(function(){return B})),n.d(e,"format",(function(){return U})),n.d(e,"escapeHtml",(function(){return F})),n.d(e,"join",(function(){return W})),n.d(e,"Local",(function(){return q})),n.d(e,"Message",(function(){return H})),n.d(e,"isMessage",(function(){return z})),n.d(e,"MessageBus",(function(){return Z})),n.d(e,"events",(function(){return G})),n.d(e,"Watcher",(function(){return ct})),n.d(e,"Observer",(function(){return Ye})),n.d(e,"parseOptions",(function(){return lt})),n.d(e,"AST",(function(){return ft})),n.d(e,"NullExpressionNode",(function(){return ht})),n.d(e,"AstNode",(function(){return yt})),n.d(e,"AssignmentExpressionNode",(function(){return gt})),n.d(e,"BinaryExpressionNode",(function(){return Ot})),n.d(e,"CallExpressionNode",(function(){return Nt})),n.d(e,"ConditionalExpressionNode",(function(){return It})),n.d(e,"ExpressionStatementNode",(function(){return Rt})),n.d(e,"IdentifierNode",(function(){return qt})),n.d(e,"LiteralNode",(function(){return Zt})),n.d(e,"LogicalExpressionNode",(function(){return te})),n.d(e,"MemberExpressionNode",(function(){return oe})),n.d(e,"ObjectExpressionNode",(function(){return le})),n.d(e,"ProgramNode",(function(){return de})),n.d(e,"PropertyNode",(function(){return ke})),n.d(e,"UnaryExpressionNode",(function(){return Se})),n.d(e,"ArrayExpressionNode",(function(){return _e})),n.d(e,"ExpLexer",(function(){return Ae})),n.d(e,"ExpParser",(function(){return De})),n.d(e,"lexExp",(function(){return Le})),n.d(e,"parseExp",(function(){return Ve})),n.d(e,"ExpBuilder",(function(){return Re})),n.d(e,"Evaluator",(function(){return Ue})),n.d(e,"Analyser",(function(){return He})),n.d(e,"VNode",(function(){return Ge})),n.d(e,"VAttr",(function(){return nn})),n.d(e,"VCmnt",(function(){return sn})),n.d(e,"VElm",(function(){return $n})),n.d(e,"VText",(function(){return An})),n.d(e,"VType",(function(){return Mn})),n.d(e,"lexTpl",(function(){return xn})),n.d(e,"parseTpl",(function(){return wn})),n.d(e,"TplBuilder",(function(){return Bn})),n.d(e,"Binding",(function(){return qn})),n.d(e,"Expression",(function(){return Fn})),n.d(e,"Render",(function(){return Yn})),n.d(e,"Component",(function(){return or})),n.d(e,"Directive",(function(){return cr})),n.d(e,"Filter",(function(){return fr})),n.d(e,"Service",(function(){return pr})),n.d(e,"isComponent",(function(){return Er})),n.d(e,"isDirective",(function(){return Or})),n.d(e,"isFilter",(function(){return Sr})),n.d(e,"isService",(function(){return Cr})),n.d(e,"namespace",(function(){return wr})),n.d(e,"bootstrap",(function(){return jr})),n.d(e,"injector",(function(){return tr})),n.d(e,"component",(function(){return $r})),n.d(e,"directive",(function(){return Nr})),n.d(e,"filter",(function(){return _r})),n.d(e,"service",(function(){return Pr}))}])}));